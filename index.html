<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ø¨ØµÙ…Ø© ØºÙŠØ± | v28 Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;800;900&display=swap');
        
        :root {
            --primary: #c5a059;
            --burgundy: #800000;
            --bg: #000000;
        }

        [data-theme="burgundy"] { --primary: var(--burgundy); }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); color: #fff; overflow-x: hidden; }

        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ */
        #maintenance-screen {
            position: fixed; inset: 0; background: #000; z-index: 9999999;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .hammer-ani { font-size: 70px; color: var(--primary); animation: hammer-swing 0.8s infinite; }
        @keyframes hammer-swing { 0%, 100% { transform: rotate(0deg); } 50% { transform: rotate(-45deg); } }
        .m-text { font-size: 1.5rem; font-weight: 900; color: var(--primary); margin-top: 25px; text-shadow: 0 0 10px var(--primary); }

        /* Ø§Ù„Ø´Ø±ÙƒØ§Ø¡ - ØªØµÙ…ÙŠÙ… ÙØ®Ù… ÙˆØ¯Ø§ÙƒÙ† */
        .partners-section { 
            height: 38vh; display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: radial-gradient(circle, #151515 0%, #000 100%);
            border-bottom: 2px solid var(--primary); position: relative;
        }
        .fancy-divider { width: 160px; height: 1px; background: linear-gradient(90deg, transparent, var(--primary), transparent); margin: 15px 0; position: relative; }
        .fancy-divider::after { content: 'â—ˆ'; position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: #000; padding: 0 10px; color: var(--primary); font-size: 18px; }

        /* Ø§Ù†ØªÙ‚Ø§Ù„ Ù†Ø§Ø¹Ù… Ù„Ù„Ø´Ø±ÙƒØ§Ø¡ */
        #p-slider img { max-height: 140px; transition: opacity 1s ease-in-out; filter: drop-shadow(0 0 15px rgba(255,255,255,0.15)); }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆÙ‡Ø¬ Ø§Ù„Ù…ØªØ³Ù„Ø³Ù„ Ù„Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
        nav { position: sticky; top: 0; z-index: 1000; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); padding: 12px; display: flex; gap: 10px; overflow-x: auto; border-bottom: 1px solid var(--primary); }
        .nav-btn { padding: 10px 25px; border: none; background: rgba(255,255,255,0.03); color: #fff; border-radius: 50px; font-weight: 800; white-space: nowrap; transition: 0.4s; animation: glowSeq 6s infinite; }
        .nav-btn.active { background: var(--primary); color: #000; animation: none; box-shadow: 0 0 20px var(--primary); }
        @keyframes glowSeq { 0%, 100% { box-shadow: none; } 50% { box-shadow: 0 0 15px var(--primary); } }

        /* Ù…Ø³Ø§Ø± Ø§Ù„Ø±Ø­Ù„Ø© */
        .journey-step { padding: 20px; border-right: 3px solid var(--primary); margin: 20px; position: relative; background: rgba(255,255,255,0.02); }
        .journey-step::before { content: ''; position: absolute; right: -9px; top: 0; width: 15px; height: 15px; background: var(--primary); border-radius: 50%; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© */
        #admin-panel { display: none; position: fixed; inset: 0; background: #000; z-index: 10000000; padding: 20px; overflow-y: auto; }
        .admin-box { border: 1.5px solid var(--primary); padding: 20px; border-radius: 15px; margin-bottom: 20px; background: #0a0a0a; }
        .theme-btn { padding: 15px; border-radius: 10px; cursor: pointer; font-weight: 900; text-align: center; border: 2px solid var(--primary); flex: 1; }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙˆØ± */
        .grid { display: grid; gap: 15px; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); padding: 20px; }
        .card { background: #111; border-radius: 15px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05); }
        .btn-order { width: 100%; padding: 15px; background: var(--primary); color: #000; border: none; font-weight: 900; cursor: pointer; }
    </style>
</head>
<body>

<div id="maintenance-screen">
    <div class="hammer-ani"><i class="fas fa-hammer"></i></div>
    <div class="m-text" id="m-text-display">ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø¥Ø¬Ø±Ø§Ø¡ ØµÙŠØ§Ù†Ø© ÙÙ†ÙŠØ©.. Ù†Ø¹ÙˆØ¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>
</div>

<div class="partners-section">
    <h2 style="color:var(--primary); font-weight:900;" id="p-title-view">Ø´Ø±ÙƒØ§Ø¡ Ø§Ù„Ù†Ø¬Ø§Ø­</h2>
    <div class="fancy-divider"></div>
    <div id="p-slider"></div>
</div>

<div id="work-status" style="text-align:center; padding:10px; background:#111; font-weight:bold; color:var(--primary); font-size:0.9rem;"></div>

<nav id="navbar"></nav>

<div id="content-area"></div>

<div id="admin-panel">
    <h1 style="color:var(--primary); text-align:center; margin-bottom:30px;">Ø¥Ø¯Ø§Ø±Ø© Ù†Ø¸Ø§Ù… Ø¨ØµÙ…Ø© ØºÙŠØ±</h1>
    
    <div class="admin-box">
        <h3 style="margin-bottom:15px;">Ø§Ù„Ø§Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠ</h3>
        <div style="display:flex; gap:10px;">
            <div class="theme-btn" style="background:#000; color:#c5a059;" onclick="changeTheme('gold')">Ø°Ù‡Ø¨ÙŠ Ùˆ Ø£Ø³ÙˆØ¯</div>
            <div class="theme-btn" style="background:#000; color:#800000;" onclick="changeTheme('burgundy')">Ø¹Ù†Ø§Ø¨ÙŠ Ùˆ Ø£Ø³ÙˆØ¯</div>
        </div>
    </div>

    <div class="admin-box">
        <h3>ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</h3>
        <label><input type="checkbox" id="m-check"> ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</label>
        <input type="text" id="m-msg-in" placeholder="Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©" style="width:100%; padding:10px; margin:10px 0; background:#222; border:1px solid #444; color:#fff;">
        <button onclick="saveM()" style="width:100%; padding:12px; background:var(--primary); border:none; font-weight:900;">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    </div>

    <button onclick="location.reload()" style="width:100%; padding:15px; background:#cc0000; color:#fff; border:none; border-radius:10px; font-weight:900;">Ø¥ØºÙ„Ø§Ù‚ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹</button>
</div>

<div onclick="openAdmin()" style="position:fixed; bottom:0; left:0; width:50px; height:50px; z-index:999999; cursor:pointer;"></div>

<script>
    const firebaseConfig = { databaseURL: "https://mydecor-b29bd-default-rtdb.europe-west1.firebasedatabase.app" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const PATH = 'site_v28';

    let siteData = {};
    let activeTab = 'home';
    let partnerStep = 0;

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙŠÙƒÙ„
    db.ref(PATH).on('value', snap => {
        siteData = snap.val() || {};
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø«ÙŠÙ…
        document.body.setAttribute('data-theme', siteData.theme || 'gold');

        // Ø§Ù„ØµÙŠØ§Ù†Ø©
        if(siteData.maintenance_mode) {
            document.getElementById('maintenance-screen').style.display = 'flex';
            document.getElementById('m-text-display').innerText = siteData.maintenance_text || 'ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©';
        } else {
            document.getElementById('maintenance-screen').style.display = 'none';
        }

        updateWorkStatus();
        renderNavbar();
        renderContent();
        initPartnerFade();
    });

    // Ø°ÙƒØ§Ø¡ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„
    function updateWorkStatus() {
        const now = new Date();
        const hour = now.getHours();
        const statusEl = document.getElementById('work-status');
        if(hour >= 9 && hour < 22) {
            statusEl.innerHTML = `ğŸŸ¢ Ù†Ø­Ù† Ù†Ø¹Ù…Ù„ Ø§Ù„Ø¢Ù† | Ù†Ø³ØªÙ‚Ø¨Ù„ Ø·Ù„Ø¨Ø§ØªÙƒÙ… Ø­ØªÙ‰ Ø§Ù„Ø³Ø§Ø¹Ø© 10:00 Ù…Ø³Ø§Ø¡Ù‹`;
        } else {
            statusEl.innerHTML = `ğŸ”´ Ù†Ø­Ù† Ù…ØºÙ„Ù‚ÙˆÙ† Ø§Ù„Ø¢Ù† | Ù†Ø¹ÙˆØ¯ Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„Ø³Ø§Ø¹Ø© 9:00 ØµØ¨Ø§Ø­Ø§Ù‹`;
        }
    }

    function renderNavbar() {
        let html = `<button class="nav-btn ${activeTab==='home'?'active':''}" onclick="setTab('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>`;
        if(siteData.pages) {
            Object.keys(siteData.pages).forEach(id => {
                html += `<button class="nav-btn ${activeTab===id?'active':''}" onclick="setTab('${id}')">${siteData.pages[id].title}</button>`;
            });
        }
        html += `<button class="nav-btn ${activeTab==='works'?'active':''}" onclick="setTab('works')">Ø£Ø¹Ù…Ø§Ù„Ù†Ø§</button>`;
        document.getElementById('navbar').innerHTML = html;
    }

    function renderContent() {
        const area = document.getElementById('content-area');
        area.innerHTML = '';

        if(activeTab === 'home') {
            area.innerHTML = `
                <div style="padding:40px 20px; text-align:center;">
                    <h1 style="color:var(--primary); font-size:2.5rem; margin-bottom:10px;">Ø¨ØµÙ…Ø© ØºÙŠØ±</h1>
                    <p style="opacity:0.8;">Ù„Ù…Ø³Ø© Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© ØªØ­ÙˆÙ„ Ø®ÙŠØ§Ù„Ùƒ Ø¥Ù„Ù‰ ÙˆØ§Ù‚Ø¹</p>
                </div>
                <div style="padding:20px;">
                    <h2 style="color:var(--primary); margin-bottom:20px;">â—ˆ Ù…Ø³Ø§Ø± Ø±Ø­Ù„ØªÙƒ Ù…Ø¹Ù†Ø§</h2>
                    <div class="journey-step"><h3>1. ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3><p>Ù†Ø¨Ø¯Ø£ Ø¨Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ ÙˆÙÙ‡Ù… Ø±Ø¤ÙŠØªÙƒ.</p></div>
                    <div class="journey-step"><h3>2. Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠ</h3><p>Ù†Ù‚Ø¯Ù… Ù„Ùƒ ØªØµÙˆÙ‘Ø± Ø£ÙˆÙ„ÙŠ Ù„Ø¥Ø¨Ø¯Ø§Ø¹Ù†Ø§.</p></div>
                    <div class="journey-step"><h3>3. Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆØ§Ù„Ø¥Ø¨Ù‡Ø§Ø±</h3><p>Ù†Ø­ÙˆÙ„ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… Ø¥Ù„Ù‰ ÙˆØ§Ù‚Ø¹ Ù…Ù„Ù…ÙˆØ³.</p></div>
                </div>
            `;
        } else if(activeTab === 'works') {
            area.innerHTML = `<div class="grid">${drawAlbums()}</div>`;
        } else if(activeTab.startsWith('alb-')) {
            const albId = activeTab.replace('alb-', '');
            area.innerHTML = `<button onclick="setTab('works')" style="color:var(--primary); padding:20px; background:none; border:none; font-weight:bold; cursor:pointer;">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù…Ø§Ù„Ù†Ø§</button><div class="grid">${drawImgs(siteData.albums[albId].imgs)}</div>`;
        } else {
            area.innerHTML = `<div class="grid">${drawImgs(siteData.pages[activeTab].imgs)}</div>`;
        }
    }

    function drawImgs(imgs) {
        if(!imgs) return '<p>Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>';
        return Object.keys(imgs).reverse().map(id => `
            <div class="card">
                <img src="${imgs[id].url}" style="width:100%; height:200px; object-fit:cover;">
                <button class="btn-order" onclick="window.open('https://wa.me/${siteData.whatsapp_num || ''}')">Ø·Ù„Ø¨ Ø§Ø³ØªØ´Ø§Ø±Ø©</button>
            </div>
        `).join('');
    }

    function drawAlbums() {
        if(!siteData.albums) return '';
        return Object.keys(siteData.albums).map(id => `
            <div class="card" onclick="setTab('alb-${id}')" style="height:150px; display:flex; align-items:center; justify-content:center; border:2px solid var(--primary); cursor:pointer;">
                <h3 style="color:var(--primary);">${siteData.albums[id].name}</h3>
            </div>
        `).join('');
    }

    function setTab(t) { activeTab = t; renderContent(); renderNavbar(); window.scrollTo(0,0); }

    function initPartnerFade() {
        if(!siteData.partners) return;
        const keys = Object.keys(siteData.partners);
        const container = document.getElementById('p-slider');
        
        function next() {
            const url = siteData.partners[keys[partnerStep]].url;
            container.innerHTML = `<img src="${url}" id="p-img" style="opacity:0">`;
            setTimeout(() => document.getElementById('p-img').style.opacity = 1, 100);
            partnerStep = (partnerStep + 1) % keys.length;
        }
        if(!window.pInt) { next(); window.pInt = setInterval(next, 4000); }
    }

    function openAdmin() {
        const p = prompt("Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:");
        db.ref('server_auth/lek').once('value', s => {
            if(p === s.val()) document.getElementById('admin-panel').style.display = 'block';
            else alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ù…Ø²");
        });
    }

    function changeTheme(t) { db.ref(PATH).update({ theme: t }); }
    function saveM() {
        db.ref(PATH).update({
            maintenance_mode: document.getElementById('m-check').checked,
            maintenance_text: document.getElementById('m-msg-in').value
        }).then(() => alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­"));
    }
</script>
</body>
</html>
