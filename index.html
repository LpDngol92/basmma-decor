<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ± ŸÑŸÑÿØŸäŸÉŸàÿ±</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿÆÿ∑Ÿàÿ∑ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;800;900&family=Amiri:wght@400;700&family=Lateef&family=Almarai:wght@300;400;800&family=Changa:wght@200;400;600;800&family=Lalezar&display=swap" rel="stylesheet">
    <style>
        /* ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆÿ∑Ÿàÿ∑ ŸÉŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ CSS */
        :root {
            --font-tajawal: 'Tajawal', sans-serif;
            --font-amiri: 'Amiri', serif;
            --font-lateef: 'Lateef', serif;
            --font-almarai: 'Almarai', sans-serif;
            --font-changa: 'Changa', sans-serif;
            --font-lalezar: 'Lalezar', cursive;
        }
        
        /* ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ŸÑŸÑÿ´ŸäŸÖ ÿßŸÑÿ£ÿ≥ŸàÿØ (ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä) */
        :root {
            --primary: #5c0a0a;
            --gold: #c5a059;
            --gold-light: #d4b483;
            --gold-dark: #8a6d3b;
            --bg: #0a0a0b;
            --card: rgba(20, 20, 22, 0.95);
            --green: #2ecc71;
            --red: #e74c3c;
            --blue: #3498db;
            --text-primary: #e0e0e0;
            --text-secondary: #aaa;
            --border: rgba(197, 160, 89, 0.15);
            --nav-bg: rgba(10,10,11,0.98);
            --input-bg: #1a1a1c;
            --input-border: #444;
            --shadow-color: rgba(0, 0, 0, 0.4);
            --about-bg: rgba(255,255,255,0.03);
            --path-bg: rgba(197, 160, 89, 0.07);
            --status-bg: rgba(255,255,255,0.03);
            --admin-bg: #111;
            --admin-section: #1a1a1c;
            --header-font: 'Tajawal', sans-serif;
            --radius-lg: 20px;
            --radius-md: 15px;
            --radius-sm: 10px;
            --transition: all 0.3s ease;
        }
        
        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            margin: 0; 
            padding: 0; 
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        img {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            pointer-events: none;
            -webkit-touch-callout: none;
        }
        
        #viewer-img {
            pointer-events: auto !important;
        }
        
        .admin-box img {
            pointer-events: auto !important;
        }
        
        body { 
            font-family: var(--header-font); 
            background: var(--bg); 
            color: var(--text-primary); 
            overflow-x: hidden; 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            transition: background-color 0.3s ease, color 0.3s ease;
            line-height: 1.6;
        }
        
        /* ÿ™ŸÜÿ®ŸäŸá ÿßŸÑÿ≠ŸÖÿßŸäÿ© */
        #protection-notification {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            z-index: 999999999;
            display: none;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: protection-notification-slide 0.3s ease-out;
            max-width: 350px;
        }
        
        @keyframes protection-notification-slide {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .protection-text-small {
            flex-grow: 1;
            line-height: 1.4;
            font-weight: bold;
        }
        
        .protection-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        #splash { 
            position: fixed; 
            inset: 0; 
            background: #000; 
            z-index: 99999999; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transition: opacity 0.5s ease; 
        }
        
        /* ÿ¥ÿßÿ¥ÿ© ÿßŸÑÿµŸäÿßŸÜÿ© */
        #maintenance-screen { 
            position: fixed; 
            inset: 0; 
            background: #000; 
            z-index: 99999999; 
            display: none; 
            align-items: center; 
            justify-content: center; 
            text-align: center; 
            flex-direction: column; 
            overflow: hidden;
        }
        
        .maintenance-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, #000 0%, #111 50%, #000 100%);
            animation: maintenance-bg 3s infinite alternate;
        }
        
        @keyframes maintenance-bg {
            0% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .maintenance-content {
            position: relative;
            z-index: 2;
            padding: 40px;
            background: rgba(10, 10, 10, 0.95);
            border-radius: var(--radius-lg);
            border: 2px solid var(--gold);
            box-shadow: 0 0 50px rgba(197, 160, 89, 0.3);
            max-width: 90%;
            animation: maintenance-pulse 2s infinite alternate;
        }
        
        /* ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿØÿßÿ±ÿ© */
        #admin-panel { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: var(--admin-bg); 
            z-index: 100000000; 
            padding: 15px; 
            overflow-y: auto; 
        }
        
        /* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ£ÿÆÿ®ÿßÿ± */
        .news-ticker { 
            background: linear-gradient(90deg, var(--gold-dark), var(--gold), var(--gold-dark));
            color: #000;
            height: 40px; 
            display: none; 
            align-items: center; 
            overflow: hidden; 
            position: relative; 
            z-index: 999; 
            font-weight: bold;
        }
        
        .ticker-content { 
            display: inline-block; 
            white-space: nowrap; 
            padding-right: 100%; 
            animation: ticker-move 20s linear infinite; 
            font-weight: 800; 
        }
        
        @keyframes ticker-move { 
            0% { transform: translateX(0); } 
            100% { transform: translateX(100%); } 
        }
        
        /* ŸÇÿ≥ŸÖ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ° */
        .partners-section { 
            height: 40vh; 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            justify-content: center; 
            position: relative; 
            background: radial-gradient(circle at center, var(--bg) 0%, var(--card) 100%); 
            overflow: hidden; 
            border-bottom: 1px solid var(--border);
        }
        
        .partners-title-container {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            padding: 0 20px;
        }
        
        .partners-title {
            color: var(--gold);
            font-weight: 900;
            font-size: 1.8rem;
            letter-spacing: 1px;
            z-index: 10;
            background: linear-gradient(135deg, #f1d39b 0%, var(--gold) 50%, #8a6d3b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 10px rgba(197, 160, 89, 0.4));
            pointer-events: none;
            position: relative;
            display: inline-block;
            font-family: var(--header-font);
        }
        
        .partner-slide-container {
            position: relative;
            width: 100%;
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .partner-slide { 
            position: absolute; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            opacity: 0; 
            transition: all 1.2s cubic-bezier(0.4, 0, 0.2, 1); 
            width: 100%;
            pointer-events: none;
            transform: scale(0.9);
        }
        
        .partner-slide.active { opacity: 1; transform: scale(1); }
        
        .partner-img { 
            max-height: 160px; 
            max-width: 80%; 
            object-fit: contain; 
            filter: drop-shadow(0 5px 15px var(--shadow-color));
            pointer-events: none;
            transition: var(--transition);
        }

        /* ========== ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÉÿ±Ÿàÿ™ ŸÖÿ≥ÿßÿ± ÿßŸÑÿ±ÿ≠ŸÑÿ© ========== */
        .work-path-container { 
            margin: 40px auto; 
            max-width: 850px; 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 20px; 
            padding: 0 15px;
        }
        
        .path-step { 
            background: linear-gradient(145deg, var(--card), var(--bg));
            border: 1px solid var(--border); 
            padding: 25px 15px; 
            border-radius: var(--radius-lg); 
            text-align: center; 
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 220px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .path-step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--gold), var(--gold-light));
            opacity: 0;
            transition: var(--transition);
        }
        
        .path-step:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(197, 160, 89, 0.15);
        }
        
        .path-step:hover::before {
            opacity: 1;
        }
        
        .path-step i { 
            color: var(--gold); 
            font-size: 2.2rem; 
            margin-bottom: 15px; 
            display: block; 
            background: rgba(197, 160, 89, 0.1);
            width: 70px;
            height: 70px;
            line-height: 70px;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .path-step:hover i {
            transform: scale(1.1);
            background: rgba(197, 160, 89, 0.2);
            box-shadow: 0 0 20px rgba(197, 160, 89, 0.3);
        }
        
        .path-step h4 { 
            font-size: 1.1rem; 
            color: var(--gold); 
            font-weight: 900; 
            margin-bottom: 10px; 
            position: relative;
            padding-bottom: 8px;
        }
        
        .path-step h4::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 50%;
            transform: translateX(50%);
            width: 40px;
            height: 2px;
            background: var(--gold);
            border-radius: 1px;
        }
        
        .path-step p { 
            font-size: 0.85rem; 
            color: var(--text-secondary); 
            line-height: 1.6; 
            margin-top: 10px;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÇÿ≥ŸÖ ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿπŸÖŸÑ */
        .schedule-container {
            background: linear-gradient(145deg, var(--card), var(--bg));
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin: 40px auto;
            max-width: 850px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .schedule-title {
            text-align: center;
            color: var(--gold);
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 15px;
        }
        
        .schedule-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 50%;
            transform: translateX(50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }
        
        .schedule-display {
            background: var(--input-bg);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 1px solid var(--border);
            margin-bottom: 25px;
        }
        
        .schedule-group {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .schedule-group:last-child {
            border-bottom: none;
        }
        
        .schedule-days {
            color: var(--gold);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .schedule-days::before {
            content: 'üìÖ';
            font-size: 1rem;
        }
        
        .time-period {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            flex-wrap: wrap;
        }
        
        .period-label {
            color: var(--text-primary);
            font-weight: bold;
            min-width: 120px;
        }
        
        .time-text {
            background: rgba(197, 160, 89, 0.1);
            padding: 5px 12px;
            border-radius: var(--radius-sm);
            color: var(--gold);
            font-weight: bold;
            border: 1px solid var(--border);
        }
        
        .time-separator {
            color: var(--text-secondary);
        }
        
        .holiday-text {
            color: var(--red);
            background: rgba(231, 76, 60, 0.1);
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-top: 15px;
            text-align: center;
            border: 1px solid rgba(231, 76, 60, 0.2);
            font-weight: bold;
        }
        
        /* ÿ≤ÿ± ÿßŸÑŸÖŸàŸÇÿπ ÿπŸÑŸâ ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸÜ */
        .location-btn {
            background: linear-gradient(135deg, var(--primary), #8a0a0a);
            color: #fff;
            border: none;
            padding: 14px 30px;
            border-radius: 50px;
            font-weight: 900;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(92, 10, 10, 0.3);
            margin: 10px 0;
        }
        
        .location-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(92, 10, 10, 0.4);
            background: linear-gradient(135deg, #7a0a0a, #9a0a0a);
        }
        
        .location-btn i {
            font-size: 1.2rem;
            color: var(--gold);
        }
        
        .status-location-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
        }
        
        /* ÿßŸÑÿ™ŸÜŸÇŸÑ */
        nav { 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            background: var(--nav-bg); 
            backdrop-filter: blur(10px); 
            padding: 15px 10px; 
            border-bottom: 2px solid var(--gold); 
            display: flex; 
            justify-content: safe center; 
            gap: 12px; 
            overflow-x: auto; 
            scroll-behavior: smooth; 
            -webkit-overflow-scrolling: touch; 
            scrollbar-width: none; 
        }
        
        nav::-webkit-scrollbar { display: none; }
        
        .nav-btn { 
            padding: 10px 25px; 
            border: none; 
            background: rgba(255,255,255,0.05); 
            color: var(--text-secondary); 
            font-weight: 800; 
            border-radius: 50px; 
            cursor: pointer; 
            white-space: nowrap; 
            flex-shrink: 0; 
            transition: var(--transition); 
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }
        
        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), #7a0a0a);
            opacity: 0;
            transition: var(--transition);
            z-index: -1;
        }
        
        .nav-btn.active { 
            color: #fff; 
            box-shadow: 0 5px 15px rgba(92, 10, 10, 0.3); 
        }
        
        .nav-btn.active::before {
            opacity: 1;
        }
        
        /* ŸÇÿ≥ŸÖ ŸÖŸÜ ŸÜÿ≠ŸÜ */
        .about-toggle { 
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border: none; 
            color: #000; 
            padding: 12px 30px; 
            border-radius: 50px; 
            font-weight: 900; 
            cursor: pointer; 
            margin-bottom: 20px; 
            transition: var(--transition); 
            display: inline-block; 
            margin-left: 10px; 
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(197, 160, 89, 0.3);
        }
        
        .about-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(197, 160, 89, 0.4);
        }
        
        .about-content { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.5s ease-out; 
            background: var(--about-bg); 
            border-radius: var(--radius-lg); 
            margin: 0 auto 20px; 
            max-width: 850px; 
            line-height: 1.7; 
            color: var(--text-secondary); 
            text-align: right; 
            border: 1px solid transparent;
        }
        
        .about-content.open { 
            max-height: 1500px; 
            padding: 30px; 
            border-color: var(--border);
        }
        
        .sec { 
            width: 95%; 
            max-width: 1400px; 
            margin: 30px auto 100px; 
            display: none; 
            flex-grow: 1; 
        }
        
        .sec.active { display: block; }
        
        /* ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ - ÿ™ÿµŸÖŸäŸÖ ŸÖÿπÿØŸÑ ŸÑÿπÿ±ÿ∂ ÿßŸÑÿµŸàÿ± */
        .grid { 
            display: grid; 
            gap: 20px; 
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
        }
        
        .card { 
            background: linear-gradient(145deg, var(--card), var(--bg));
            border-radius: var(--radius-lg); 
            overflow: hidden; 
            border: 1px solid var(--border); 
            position: relative; 
            transition: var(--transition);
            height: 100%;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(197, 160, 89, 0.15);
            border-color: rgba(197, 160, 89, 0.3);
        }
        
        .img-container { 
            position: relative; 
            width: 100%; 
            height: 180px; 
            cursor: pointer; 
            overflow: hidden; 
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--input-bg);
        }
        
        .img-container img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: transform 0.5s ease;
        }
        
        .img-container:hover img {
            transform: scale(1.08);
        }
        
        .wm-tag { 
            position: absolute; 
            bottom: 12px; 
            left: 50%; 
            transform: translateX(-50%); 
            font-size: 0.8rem; 
            font-weight: 900; 
            color: rgba(255, 255, 255, 0.4); 
            text-shadow: 0 0 10px var(--gold); 
            pointer-events: none; 
            z-index: 2; 
            white-space: nowrap; 
            background: rgba(0, 0, 0, 0.5);
            padding: 4px 12px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }
        
        .btn-order { 
            width: 100%; 
            padding: 14px; 
            background: linear-gradient(135deg, var(--primary), #7a0a0a);
            color: #fff; 
            border: none; 
            font-weight: 900; 
            cursor: pointer; 
            transition: var(--transition);
            font-size: 0.95rem;
        }
        
        .btn-order:hover {
            background: linear-gradient(135deg, #7a0a0a, #9a0a0a);
        }
        
        .whatsapp-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            border-radius: 50px;
            padding: 18px 45px;
            width: auto;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            font-weight: 900;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-size: 1.1rem;
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.3);
            margin: 20px 0;
        }
        
        .whatsapp-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(37, 211, 102, 0.4);
            background: linear-gradient(135deg, #2ae673, #139e88);
        }
        
        .status-badge { 
            padding: 12px 30px; 
            border-radius: 50px; 
            font-weight: 900; 
            display: inline-flex; 
            align-items: center; 
            gap: 10px; 
            font-size: 1rem; 
            transition: var(--transition); 
        }
        
        .open-glow { 
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.2), rgba(46, 204, 113, 0.1)); 
            color: #2ecc71; 
            border: 2px solid #2ecc71; 
            box-shadow: 0 5px 20px rgba(46, 204, 113, 0.3); 
        }
        
        .closed-glow { 
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.2), rgba(231, 76, 60, 0.1)); 
            color: #e74c3c; 
            border: 2px solid #e74c3c; 
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.3); 
        }
        
        .social-icons { 
            display: flex; 
            justify-content: center; 
            gap: 30px; 
            margin-top: 40px; 
        }
        
        .social-icons a { 
            color: var(--gold); 
            font-size: 2rem; 
            transition: var(--transition); 
            background: rgba(197, 160, 89, 0.1);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .social-icons a:hover {
            transform: translateY(-5px) scale(1.1);
            background: rgba(197, 160, 89, 0.2);
            box-shadow: 0 10px 20px rgba(197, 160, 89, 0.2);
        }
        
        /* ========== ÿßŸÑŸÖÿπÿ±ÿ∂ ÿßŸÑŸÖÿπÿØŸÑ ========== */
        #viewer { 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.98); 
            z-index: 1000000; 
            display: none; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer;
        }
        
        #viewer-img { 
            max-width: 95%; 
            max-height: 95vh; 
            object-fit: contain;
            cursor: default;
            position: relative;
        }
        
        .viewer-watermark {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255,255,255,0.3);
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(197, 160, 89, 0.5);
            pointer-events: none;
            z-index: 1000001;
        }
        
        .close-viewer-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1000002;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .close-viewer-btn:hover {
            background: #e74c3c;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.5);
        }
        /* ========== ŸÜŸáÿßŸäÿ© ÿßŸÑŸÖÿπÿ±ÿ∂ ÿßŸÑŸÖÿπÿØŸÑ ========== */
        
        .admin-box { 
            max-width: 900px; 
            margin: 20px auto; 
            background: var(--admin-bg); 
            padding: 25px; 
            border-radius: var(--radius-lg); 
            border: 2px solid var(--gold); 
            color: var(--text-primary);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .collapse-section { 
            background: var(--admin-section); 
            border-radius: var(--radius-md); 
            margin-bottom: 15px; 
            border: 1px solid var(--border); 
            overflow: hidden;
        }
        
        .collapse-btn { 
            width: 100%; 
            padding: 18px; 
            background: linear-gradient(135deg, var(--admin-section), var(--input-bg));
            border: none; 
            color: var(--gold); 
            font-weight: 900; 
            text-align: right; 
            display: flex; 
            justify-content: space-between; 
            cursor: pointer;
            font-size: 1.1rem;
            transition: var(--transition);
        }
        
        .collapse-btn:hover {
            background: linear-gradient(135deg, var(--input-bg), var(--admin-section));
        }
        
        .collapse-content { 
            display: none; 
            padding: 20px; 
            border-top: 1px solid var(--border); 
        }
        
        input, textarea, select { 
            width: 100%; 
            padding: 14px; 
            margin-bottom: 15px; 
            background: var(--input-bg); 
            border: 1px solid var(--input-border); 
            color: var(--text-primary); 
            border-radius: var(--radius-sm); 
            font-family: 'Tajawal'; 
            transition: var(--transition);
            font-size: 1rem;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--gold);
            outline: none;
            box-shadow: 0 0 10px rgba(197, 160, 89, 0.2);
        }
        
        /* ========== ŸÖÿ≠ÿ±ÿ± "ŸÖŸÜ ŸÜÿ≠ŸÜ" ÿßŸÑŸÖÿ≠ÿ≥ŸÜ ========== */
        #editor-about { 
            min-height: 300px;
            background: var(--input-bg);
            border: 1px solid var(--input-border);
            padding: 20px;
            border-radius: var(--radius-md);
            color: var(--text-primary);
            outline: none;
            text-align: right;
            line-height: 1.8;
            font-size: 1.1rem;
            overflow-y: auto;
        }
        
        #editor-about h1, #editor-about h2, #editor-about h3, #editor-about h4 {
            color: var(--gold);
            margin: 20px 0 15px 0;
            font-weight: bold;
        }
        
        #editor-about h1 { font-size: 1.9rem; }
        #editor-about h2 { font-size: 1.6rem; }
        #editor-about h3 { font-size: 1.4rem; }
        #editor-about h4 { font-size: 1.2rem; }
        
        #editor-about b, #editor-about strong {
            color: var(--gold);
            font-weight: bold;
        }
        
        #editor-about i, #editor-about em {
            font-style: italic;
            color: var(--text-secondary);
        }
        
        #editor-about u {
            text-decoration: underline;
            color: var(--gold);
        }
        
        #editor-about ul, #editor-about ol {
            padding-right: 25px;
            margin: 15px 0;
        }
        
        #editor-about li {
            margin-bottom: 8px;
        }
        
        #editor-about a {
            color: var(--gold);
            text-decoration: underline;
        }
        
        /* ÿ¥ÿ±Ÿäÿ∑ ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ */
        .format-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
            padding: 15px;
            background: var(--admin-section);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
        }
        
        .format-btn {
            width: 45px;
            height: 45px;
            background: var(--input-bg);
            border: 1px solid var(--input-border);
            color: var(--text-primary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: var(--transition);
        }
        
        .format-btn:hover {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
        }
        
        .format-btn.active {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
        }
        
        /* ========== ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ© ÿßŸÑŸÖÿµŸÑÿ≠ÿ© ========== */
        .drawing-section {
            background: linear-gradient(145deg, var(--card), var(--bg));
            border-radius: var(--radius-lg);
            padding: 30px;
            margin: 40px auto;
            max-width: 1200px;
            border: 1px solid var(--border);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
        }
        
        .drawing-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(197, 160, 89, 0.1) 0%, transparent 70%);
            z-index: 0;
        }
        
        .drawing-title {
            color: var(--gold);
            font-size: 2.2rem;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 900;
            position: relative;
            padding-bottom: 15px;
            z-index: 1;
        }
        
        .drawing-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 50%;
            transform: translateX(50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }
        
        .drawing-description {
            color: var(--text-secondary);
            margin-bottom: 30px;
            line-height: 1.8;
            text-align: center;
            font-size: 1.2rem;
            background: rgba(197, 160, 89, 0.05);
            padding: 25px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            z-index: 1;
            position: relative;
        }
        
        /* ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© */
        .drawing-tools-container {
            background: var(--input-bg);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            z-index: 1;
            position: relative;
        }
        
        .tool-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-md);
            padding: 15px;
            border: 1px solid var(--border);
        }
        
        .tool-section-title {
            color: var(--gold);
            font-size: 1.1rem;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .drawing-tools-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .tool-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.08);
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 120px;
            justify-content: center;
        }
        
        .tool-btn.active {
            background: var(--gold);
            color: #000;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(197, 160, 89, 0.3);
        }
        
        .tool-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .color-palette-drawing {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .color-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .color-dot:hover {
            transform: scale(1.15);
        }
        
        .color-dot.selected {
            border-color: #fff;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }
        
        .brush-size-control {
            display: flex;
            flex-direction: column;
            gap: 15px;
            color: var(--text-primary);
            margin: 15px 0;
        }
        
        .brush-size-control label {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .brush-size-slider {
            width: 100%;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .brush-size-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--gold);
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .brush-size-display {
            display: inline-block;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--gold);
            color: #000;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }
        
        /* ÿ≠ÿßŸàŸäÿ© ÿßŸÑŸÉÿßŸÜŸÅÿßÿ≥ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© */
        .drawing-canvas-container {
            background: #ffffff;
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin: 25px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            position: relative;
            min-height: 500px;
            display: block;
            border: 2px solid var(--border);
        }
        
        /* ÿßŸÑŸÉÿßŸÜŸÅÿßÿ≥ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ */
        .drawing-canvas {
            width: 100%;
            height: 500px;
            display: block;
            cursor: crosshair;
            background: #f9f9f9;
            touch-action: none;
            -webkit-touch-callout: none;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        .drawing-welcome {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #aaa;
            font-size: 1.3rem;
            pointer-events: none;
            z-index: 1;
            background: rgba(255, 255, 255, 0.9);
            padding: 30px 50px;
            border-radius: var(--radius-lg);
            border: 2px dashed var(--gold);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .drawing-welcome i {
            font-size: 3rem;
            color: var(--gold);
            margin-bottom: 15px;
            display: block;
        }
        
        .canvas-controls {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .drawing-action-btn {
            padding: 18px 35px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 15px;
            border: none;
            min-width: 220px;
            justify-content: center;
        }
        
        .drawing-action-btn.whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.3);
        }
        
        .drawing-action-btn.download {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: #000;
            box-shadow: 0 8px 20px rgba(197, 160, 89, 0.3);
        }
        
        .drawing-action-btn.clear {
            background: linear-gradient(135deg, var(--red), #c0392b);
            color: white;
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.3);
        }
        
        .drawing-action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px rgba(0,0,0,0.3);
        }
        
        .drawing-info {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-top: 25px;
            text-align: center;
            padding: 20px;
            background: rgba(197, 160, 89, 0.05);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            line-height: 1.7;
        }
        
        /* ========== ÿ£ÿØÿßÿ© ÿßŸÑÿ£ÿ¥ŸÉÿßŸÑ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© ========== */
        .shape-tools {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .shape-btn {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--input-border);
            color: var(--text-primary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            transition: var(--transition);
        }
        
        .shape-btn.active {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
            transform: scale(1.1);
        }
        
        .shape-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        footer { 
            padding: 25px; 
            text-align: center; 
            color: var(--text-secondary); 
            font-size: 1rem; 
            border-top: 1px solid var(--border); 
            margin-top: auto; 
            background: var(--card);
        }
        
        /* ÿ≤ÿ± ÿ™ŸÅÿπŸäŸÑ/ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ŸÑŸÑŸÖÿ¥ÿ±ŸÅ */
        #protection-toggle {
            position: fixed;
            bottom: 80px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--green), #27ae60);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 200000001;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: var(--transition);
        }
        
        #protection-toggle.active {
            background: linear-gradient(135deg, var(--red), #c0392b);
        }
        
        #protection-toggle:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }
        
        /* ÿ™ÿ∞ŸäŸäŸÑ ÿßŸÑÿ±ÿ≥ŸÖ */
        .drawing-footer {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 20px;
            padding: 15px;
            border-top: 1px solid var(--border);
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ¨ŸàÿßŸÑ */
        @media (max-width: 768px) {
            .work-path-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .path-step {
                min-height: 200px;
                padding: 20px 10px;
            }
            
            .drawing-tools-container {
                grid-template-columns: 1fr;
            }
            
            .canvas-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .drawing-action-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .schedule-container {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .work-path-container {
                grid-template-columns: 1fr;
            }
            
            .nav-btn {
                padding: 8px 18px;
                font-size: 0.85rem;
            }
            
            .drawing-title {
                font-size: 1.8rem;
            }
            
            .drawing-description {
                font-size: 1rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
<!-- ÿ™ŸÜÿ®ŸäŸá ÿßŸÑÿ≠ŸÖÿßŸäÿ© -->
<div id="protection-notification">
    <div class="protection-text-small" id="protection-message-content">
        ÿ™ŸÖ ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿÆÿßÿµŸäÿ© ŸÖŸÜ ŸÇÿ®ŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ©
    </div>
    <button class="protection-close" onclick="closeProtectionNotification()">
        <i class="fas fa-times"></i>
    </button>
</div>

<div id="splash"> 
    <h2 style="color:var(--gold); font-size:2.5rem;">ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ±...</h2> 
</div>

<!-- ÿ¥ÿßÿ¥ÿ© ÿßŸÑÿµŸäÿßŸÜÿ© -->
<div id="maintenance-screen"> 
    <div class="maintenance-overlay"></div>
    <div class="maintenance-content">
        <div class="maintenance-icon">
            <i class="fas fa-tools"></i>
        </div>
        <h1 class="maintenance-title" id="maintenance-title">ÿßŸÑŸÖŸàŸÇÿπ ŸÅŸä ÿµŸäÿßŸÜÿ©</h1>
        <p class="maintenance-message" id="maintenance-message">ŸÜÿπŸÖŸÑ ÿπŸÑŸâ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ™ÿ¨ÿ±ÿ®ÿ™ŸÉÿå ÿ≥ŸÜÿπŸàÿØ ŸÇÿ±Ÿäÿ®ÿßŸã ÿ®ÿ•ÿµÿØÿßÿ± ÿ¨ÿØŸäÿØ ŸàŸÖŸÖŸäÿ≤</p>
        <div class="maintenance-progress">
            <div class="maintenance-progress-bar"></div>
        </div>
        <p class="maintenance-footer" id="maintenance-footer">¬© ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ± ŸÑŸÑÿØŸäŸÉŸàÿ±</p>
    </div>
</div>

<div class="partners-section">
    <div class="partners-title-container">
        <div id="partners-title-text" class="partners-title"></div>
    </div>
    <div id="partners-display" class="partner-slide-container"></div>
</div>

<div id="news-container" class="news-ticker">
    <div class="ticker-content" id="news-text"></div>
</div>

<nav id="navbar"></nav>

<main id="content-area"></main>

<footer id="site-footer"></footer>

<div id="cat-overlay">
    <div style="background:var(--primary); padding:15px; text-align:center; color:#fff; font-weight:bold; cursor:pointer;" onclick="this.parentElement.style.display='none'">ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÉÿ™ÿßŸÑŸàÿ¨ X</div>
    <div id="cat-frame" style="flex-grow:1; background:#fff;"></div>
</div>

<!-- ÿ≤ÿ± ÿ™ŸÅÿπŸäŸÑ/ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ŸÑŸÑŸÖÿ¥ÿ±ŸÅ -->
<button id="protection-toggle" onclick="toggleProtection()" title="ÿ™ŸÅÿπŸäŸÑ/ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ©">
    <i class="fas fa-shield-alt"></i>
</button>

<!-- ========== ÿßŸÑŸÖÿπÿ±ÿ∂ ÿßŸÑŸÖÿπÿØŸÑ ========== -->
<div id="viewer" onclick="closeViewerOnOverlay(event)">
    <button class="close-viewer-btn" onclick="closeViewer()">
        <i class="fas fa-times"></i>
    </button>
    <img id="viewer-img" src="">
    <div class="viewer-watermark" id="viewer-watermark"></div>
</div>
<!-- ========== ŸÜŸáÿßŸäÿ© ÿßŸÑŸÖÿπÿ±ÿ∂ ÿßŸÑŸÖÿπÿØŸÑ ========== -->

<div id="admin-panel">
    <div class="admin-box">
        <h2 style="color:var(--gold); text-align:center; margin-bottom:25px; font-size:2rem;">ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿØÿßÿ±ÿ©</h2>
        
        <!-- ŸÇÿ≥ŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≠ŸÖÿßŸäÿ© -->
        <div class="collapse-section">
            <button class="collapse-btn" onclick="toggleCol('c_protection')">üõ°Ô∏è ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ©</button>
            <div id="c_protection" class="collapse-content">
                <div style="text-align:center; padding:20px;">
                    <h3 style="color:var(--gold); margin-bottom:20px;">ÿ•ÿπÿØÿßÿØÿßÿ™ ÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ</h3>
                    
                    <div style="text-align:right; margin-bottom:20px;">
                        <label style="display:block; margin-bottom:15px; color:var(--text-primary);">
                            <input type="checkbox" id="enable-right-click-protection" checked>
                            ŸÖŸÜÿπ ÿßŸÑŸÜŸÇÿ± ÿ®ÿßŸÑÿ≤ÿ± ÿßŸÑÿ£ŸäŸÖŸÜ
                        </label>
                        <label style="display:block; margin-bottom:15px; color:var(--text-primary);">
                            <input type="checkbox" id="enable-keyboard-protection" checked>
                            ŸÖŸÜÿπ ÿßÿÆÿ™ÿµÿßÿ±ÿßÿ™ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖŸÅÿßÿ™Ÿäÿ≠
                        </label>
                        <label style="display:block; margin-bottom:15px; color:var(--text-primary);">
                            <input type="checkbox" id="enable-image-protection" checked>
                            ŸÖŸÜÿπ ÿ≥ÿ≠ÿ® Ÿàÿ≠ŸÅÿ∏ ÿßŸÑÿµŸàÿ±
                        </label>
                        <label style="display:block; margin-bottom:15px; color:var(--text-primary);">
                            <input type="checkbox" id="enable-selection-protection" checked>
                            ŸÖŸÜÿπ ŸÜÿ≥ÿÆ ÿßŸÑŸÜÿµŸàÿµ
                        </label>
                        <label style="display:block; margin-bottom:15px; color:var(--text-primary);">
                            <input type="checkbox" id="enable-drawing-exemption" checked>
                            ÿ•ÿπŸÅÿßÿ° ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ© ŸÖŸÜ ÿßŸÑÿ≠ŸÖÿßŸäÿ©
                        </label>
                    </div>
                    
                    <div style="margin-top:20px; padding:20px; background:rgba(197, 160, 89, 0.1); border-radius:var(--radius-md);">
                        <p style="color:var(--gold); font-weight:bold; margin-bottom:10px;">ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ≠ŸÖÿßŸäÿ©:</p>
                        <textarea id="protection-message-text" rows="3" style="width:100%; background:var(--input-bg); color:var(--text-primary); border:1px solid var(--border); padding:15px; border-radius:var(--radius-sm); font-size:1rem;">‚õî Ÿáÿ∞Ÿá ÿßŸÑÿÆÿßÿµŸäÿ© ŸÖÿπÿ∑ŸÑÿ© - ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÖÿ≠ŸÖŸä ÿ®ÿ≠ŸÇŸàŸÇ ÿßŸÑŸÜÿ¥ÿ±</textarea>
                        <button onclick="saveProtectionSettings()" style="width:100%; background:linear-gradient(135deg, var(--gold), var(--gold-dark)); color:#000; padding:12px; border:none; border-radius:var(--radius-sm); margin-top:15px; font-weight:bold; font-size:1rem;">ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ©</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ŸÇÿ≥ŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿÆÿ∑Ÿàÿ∑ -->
        <div class="collapse-section">
            <button class="collapse-btn" onclick="toggleCol('c_fonts')">üî† ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿÆÿ∑Ÿàÿ∑</button>
            <div id="c_fonts" class="collapse-content">
                <div style="text-align:center; padding:20px;">
                    <h3 style="color:var(--gold); margin-bottom:20px;">ÿßÿÆÿ™ÿ± ÿÆÿ∑ ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä</h3>
                    
                    <div class="font-preview">
                        <div class="font-option tajawal" onclick="selectFont('tajawal')">
                            <div style="font-size:1.3rem; margin-bottom:5px;">ÿ™ÿßÿ¨ŸàÿßŸÑ</div>
                            <div style="font-size:0.9rem; color:var(--text-secondary);">ÿÆÿ∑ ÿπÿ±ÿ®Ÿä ÿ£ŸÜŸäŸÇ Ÿàÿπÿµÿ±Ÿä</div>
                        </div>
                        
                        <div class="font-option amiri" onclick="selectFont('amiri')">
                            <div style="font-size:1.3rem; margin-bottom:5px;">ÿ£ŸÖŸäÿ±Ÿä</div>
                            <div style="font-size:0.9rem; color:var(--text-secondary);">ÿÆÿ∑ ŸÉŸÑÿßÿ≥ŸäŸÉŸä ŸÑŸÑÿπŸÜÿßŸàŸäŸÜ</div>
                        </div>
                        
                        <div class="font-option lateef" onclick="selectFont('lateef')">
                            <div style="font-size:1.3rem; margin-bottom:5px;">ŸÑÿ∑ŸäŸÅ</div>
                            <div style="font-size:0.9rem; color:var(--text-secondary);">ÿÆÿ∑ ŸäÿØŸàŸä ÿ±ÿµŸäŸÜ</div>
                        </div>
                        
                        <div class="font-option almarai" onclick="selectFont('almarai')">
                            <div style="font-size:1.3rem; margin-bottom:5px;">ÿßŸÑŸÖÿ≥ÿ±Ÿâ</div>
                            <div style="font-size:0.9rem; color:var(--text-secondary);">ÿÆÿ∑ ÿ≠ÿØŸäÿ´ Ÿàÿ¨ÿ±Ÿäÿ°</div>
                        </div>
                        
                        <div class="font-option changa" onclick="selectFont('changa')">
                            <div style="font-size:1.3rem; margin-bottom:5px;">ÿ™ÿ∫ŸäŸäÿ±</div>
                            <div style="font-size:0.9rem; color:var(--text-secondary);">ÿÆÿ∑ ŸÅŸÜŸä Ÿàÿ•ÿ®ÿØÿßÿπŸä</div>
                        </div>
                        
                        <div class="font-option lalezar" onclick="selectFont('lalezar')">
                            <div style="font-size:1.3rem; margin-bottom:5px;">ŸÑÿßŸÑŸá ÿ≤ÿßÿ±</div>
                            <div style="font-size:0.9rem; color:var(--text-secondary);">ÿÆÿ∑ ŸÖŸÖŸäÿ≤ ŸàŸÅÿ±ŸäÿØ</div>
                        </div>
                    </div>
                    
                    <div style="margin-top:25px;">
                        <p style="color:var(--text-secondary); margin-bottom:10px;">ÿ£Ÿà ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿÆÿ∑ ŸÖÿÆÿµÿµ:</p>
                        <input type="text" id="custom-font-input" placeholder="ŸÖÿ´ÿßŸÑ: 'Cairo', 'Almarai', 'Arial'" style="margin-bottom:15px;">
                        <button onclick="selectCustomFont()" style="width:100%; background:linear-gradient(135deg, var(--gold), var(--gold-dark)); color:#000; padding:12px; border:none; border-radius:var(--radius-sm); font-weight:bold; font-size:1rem;">ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿÆÿ∑ ÿßŸÑŸÖÿÆÿµÿµ</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ŸÇÿ≥ŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ© -->
        <div class="collapse-section">
            <button class="collapse-btn" onclick="toggleCol('c_drawing')">üé® ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©</button>
            <div id="c_drawing" class="collapse-content">
                <div style="text-align:center; padding:20px;">
                    <h3 style="color:var(--gold); margin-bottom:20px;">ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©</h3>
                    
                    <div style="text-align:right; margin-bottom:20px;">
                        <label style="display:block; margin-bottom:15px; color:var(--text-primary);">
                            <input type="checkbox" id="enable-drawing-section" checked>
                            ÿ™ŸÅÿπŸäŸÑ ŸÇÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©
                        </label>
                    </div>
                    
                    <input type="text" id="drawing-title-input" placeholder="ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÇÿ≥ŸÖ (ŸÖÿ´ÿßŸÑ: ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©)" value="ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©">
                    <textarea id="drawing-description-input" placeholder="ŸàÿµŸÅ ÿßŸÑŸÇÿ≥ŸÖ" rows="3">ŸäŸÖŸÉŸÜŸÉ ŸáŸÜÿß ÿ±ÿ≥ŸÖ ŸÅŸÉÿ±ÿ™ŸÉ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ®Ÿäÿ© ŸÑŸÑÿ™ÿµŸÖŸäŸÖ. ÿßÿ±ÿ≥ŸÖ ŸÖÿß Ÿäÿ¨ŸàŸÑ ÿ®ÿÆÿßÿ∑ÿ±ŸÉ Ÿàÿ≥ŸÜŸÇŸàŸÖ ÿ®ÿ™ÿ≠ŸàŸäŸÑŸá ÿ•ŸÑŸâ ŸàÿßŸÇÿπ!</textarea>
                    <input type="text" id="drawing-button-text" placeholder="ŸÜÿµ ÿßŸÑÿ≤ÿ± ŸÅŸä ÿßŸÑÿ™ŸÜŸÇŸÑ" value="ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©">
                    <input type="text" id="drawing-whatsapp-message" placeholder="ÿ±ÿ≥ÿßŸÑÿ© Ÿàÿßÿ™ÿ≥ÿßÿ® ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©" value="ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖÿå ÿ£ŸàÿØ ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑Ÿä:">
                    
                    <button onclick="saveDrawingSettings()" style="width:100%; background:linear-gradient(135deg, var(--gold), var(--gold-dark)); color:#000; padding:14px; border:none; border-radius:var(--radius-sm); margin-top:15px; font-weight:bold; font-size:1rem;">ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©</button>
                </div>
            </div>
        </div>

        <!-- ÿ®ÿßŸÇŸä ÿ£ŸÇÿ≥ÿßŸÖ ÿßŸÑÿ•ÿØÿßÿ±ÿ© (ÿ™ŸÖ ÿßÿÆÿ™ÿµÿßÿ±Ÿáÿß ŸÑŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ ÿßŸÑŸÖŸáŸÖÿ©) -->
        <div class="collapse-section">
            <button class="collapse-btn" onclick="toggleCol('c_set')">‚öôÔ∏è ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©</button>
            <div id="c_set" class="collapse-content">
                <input type="text" id="in-name" placeholder="ÿßÿ≥ŸÖ ÿßŸÑŸÖŸàŸÇÿπ">
                <input type="text" id="in-wa" placeholder="Ÿàÿßÿ™ÿ≥ÿßÿ®">
                <input type="text" id="in-logo" placeholder="ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ¥ÿπÿßÿ±">
                <input type="text" id="in-wm" placeholder="ŸÜÿµ ÿßŸÑŸàÿ™ÿ± ŸÖÿßÿ±ŸÉ">
                <textarea id="in-news" placeholder="ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ£ÿÆÿ®ÿßÿ±"></textarea>
                <input type="text" id="in-footer" placeholder="ŸÜÿµ ÿ≠ŸÇŸàŸÇ ÿßŸÑÿ≠ŸÅÿ∏">
                <button onclick="saveSettings()" style="width:100%; background:linear-gradient(135deg, var(--gold), var(--gold-dark)); color:#000; padding:14px; border:none; border-radius:var(--radius-sm); margin-top:10px; font-weight:bold; font-size:1rem;">ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</button>
            </div>
        </div>
        
        <button onclick="location.reload()" style="width:100%; background:linear-gradient(135deg, var(--red), #c0392b); color:#fff; padding:16px; border:none; border-radius:var(--radius-sm); margin-top:25px; font-weight:bold; font-size:1.1rem;">ÿÆÿ±Ÿàÿ¨ ŸÖŸÜ ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿØÿßÿ±ÿ©</button>
    </div>
</div>

<div id="hidden-trigger" onclick="checkAccess()"></div>

<script>
    // ========== ÿ™ŸáŸäÿ¶ÿ© Firebase ==========
    const firebaseConfig = {
        apiKey: "AIzaSyC0hGvWzpb0UxA_RrYn-0PQKyaATXavEGY",
        authDomain: "mydecor-b29bd.firebaseapp.com",
        databaseURL: "https://mydecor-b29bd-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "mydecor-b29bd",
        storageBucket: "mydecor-b29bd.firebasestorage.app",
        messagingSenderId: "302609299720",
        appId: "1:302609299720:web:e086b600c3ee824acd54bd"
    };

    firebase.initializeApp(firebaseConfig);
    
    const db = firebase.database();
    const auth = firebase.auth();
    const DB_PATH = 'site_v28';
    
    let currentData = {}; 
    let currentTab = 'home'; 
    let isAdmin = false; 
    let userRating = 0; 
    let reviewIdx = 0; 
    let partnerIdx = 0;
    let selectedFont = 'tajawal';
    
    // ========== ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ==========
    let isProtectionEnabled = true;
    let isDrawingExempted = true;
    let protectionSettings = {
        rightClick: true,
        keyboardShortcuts: true,
        imageProtection: true,
        textSelection: true,
        drawingExemption: true
    };
    
    // ========== ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© ==========
    let drawingCanvas, drawingCtx;
    let currentDrawingTool = 'pen';
    let currentDrawingColor = '#000000';
    let currentBrushSize = 5;
    let isDrawing = false;
    let lastX = 0;
    let lastY = 0;
    let isDrawingShape = false;
    let startX, startY;
    let currentShape = '';
    let savedCanvasState = null;
    
    // ========== ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿµŸÅÿ≠ÿ© ==========
    document.addEventListener('DOMContentLoaded', function() {
        enableProtection();
        setupAuthListener();
    });
    
    // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖÿµÿßÿØŸÇÿ© ==========
    function setupAuthListener() {
        auth.onAuthStateChanged((user) => {
            if (user) {
                isAdmin = true;
                activateAdminPanel(user);
            } else {
                isAdmin = false;
            }
        });
    }
    
    function checkAccess() {
        const userInput = prompt("üîê ÿ£ÿØÿÆŸÑ ÿ±ŸÖÿ≤ ÿßŸÑÿ•ÿØÿßÿ±ÿ©:");
        if (!userInput) return;
        
        db.ref(DB_PATH).once('value')
            .then(snapshot => {
                const data = snapshot.val();
                
                if (!data) {
                    showProtectionNotification("‚ùå ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™");
                    return;
                }
                
                if (data.in && data.in.toString() === userInput.toString()) {
                    enterAdminPanel();
                    return;
                }
                
                if (data.in && typeof data.in === 'string' && data.in.trim() === userInput.trim()) {
                    enterAdminPanel();
                    return;
                }
                
                let found = false;
                for (const key in data) {
                    if (data[key] && data[key].toString() === userInput.toString()) {
                        found = true;
                        break;
                    }
                }
                
                if (found) {
                    enterAdminPanel();
                } else {
                    showProtectionNotification("‚ùå ÿßŸÑÿ±ŸÖÿ≤ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠! ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ±ŸÇŸÖ.");
                }
            })
            .catch(error => {
                console.error("üö® ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ:", error);
                showProtectionNotification("‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿÆÿßÿØŸÖ: " + error.message);
            });
    }
    
    function enterAdminPanel() {
        isAdmin = true;
        document.getElementById('admin-panel').style.display = 'block';
        document.getElementById('protection-toggle').style.display = 'flex';
        showProtectionNotification("‚úÖ ÿ™ŸÖ ÿßŸÑÿØÿÆŸàŸÑ ŸÑŸÑÿ•ÿØÿßÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠");
        fillAdminFields();
        localStorage.setItem('admin_session', 'active');
    }
    
    function activateAdminPanel(user) {
        isAdmin = true;
        document.getElementById('admin-panel').style.display = 'block';
        document.getElementById('protection-toggle').style.display = 'flex';
        hideMaintenanceScreen();
        fillAdminFields();
    }
    
    // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿπÿØŸÑ ==========
    function enableProtection() {
        if (!isProtectionEnabled) return;
        
        document.addEventListener('contextmenu', preventRightClick);
        document.addEventListener('keydown', preventKeyboardShortcuts);
        document.addEventListener('dragstart', preventImageDrag);
        document.addEventListener('drop', preventImageDrop);
        document.addEventListener('copy', preventCopy);
        document.addEventListener('cut', preventCopy);
        document.addEventListener('selectstart', preventSelection);
    }
    
    function disableProtection() {
        document.removeEventListener('contextmenu', preventRightClick);
        document.removeEventListener('keydown', preventKeyboardShortcuts);
        document.removeEventListener('dragstart', preventImageDrag);
        document.removeEventListener('drop', preventImageDrop);
        document.removeEventListener('copy', preventCopy);
        document.removeEventListener('cut', preventCopy);
        document.removeEventListener('selectstart', preventSelection);
    }
    
    function toggleProtection() {
        isProtectionEnabled = !isProtectionEnabled;
        const toggleBtn = document.getElementById('protection-toggle');
        
        if (isProtectionEnabled) {
            enableProtection();
            toggleBtn.classList.remove('active');
            toggleBtn.innerHTML = '<i class="fas fa-shield-alt"></i>';
            showProtectionNotification('ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ©');
        } else {
            disableProtection();
            toggleBtn.classList.add('active');
            toggleBtn.innerHTML = '<i class="fas fa-shield-slash"></i>';
            showProtectionNotification('ÿ™ŸÖ ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ŸÖÿ§ŸÇÿ™ÿßŸã');
        }
    }
    
    function preventRightClick(e) {
        if (!isProtectionEnabled || isDrawingExempted && isInDrawingArea(e.target)) {
            return;
        }
        e.preventDefault();
        showProtectionNotification('rightClick');
        return false;
    }
    
    function preventKeyboardShortcuts(e) {
        if (!isProtectionEnabled || isDrawingExempted && isInDrawingArea(e.target)) {
            return;
        }
        
        if (e.keyCode === 123 || 
            (e.ctrlKey && e.shiftKey && e.keyCode === 73) || 
            (e.ctrlKey && e.keyCode === 85) ||
            (e.ctrlKey && e.keyCode === 83) ||
            (e.ctrlKey && e.keyCode === 80)) {
            e.preventDefault();
            showProtectionNotification('devTools');
            return false;
        }
    }
    
    function preventImageDrag(e) {
        if (!isProtectionEnabled || isDrawingExempted && isInDrawingArea(e.target)) {
            return;
        }
        if (e.target.tagName === 'IMG' && !e.target.id.includes('drawing')) {
            e.preventDefault();
            showProtectionNotification('imageProtection');
            return false;
        }
    }
    
    function preventImageDrop(e) {
        if (!isProtectionEnabled || isDrawingExempted && isInDrawingArea(e.target)) {
            return;
        }
        e.preventDefault();
        showProtectionNotification('imageProtection');
        return false;
    }
    
    function preventCopy(e) {
        if (!isProtectionEnabled || isDrawingExempted && isInDrawingArea(e.target)) {
            return;
        }
        const tagName = e.target.tagName;
        if (tagName !== 'INPUT' && tagName !== 'TEXTAREA' && !isInDrawingArea(e.target)) {
            e.preventDefault();
            showProtectionNotification('copy');
            return false;
        }
    }
    
    function preventSelection(e) {
        if (!isProtectionEnabled || isDrawingExempted && isInDrawingArea(e.target)) {
            return;
        }
        if (!isInDrawingArea(e.target)) {
            e.preventDefault();
        }
    }
    
    function isInDrawingArea(element) {
        if (!element) return false;
        
        while (element) {
            if (element.classList && (
                element.classList.contains('drawing-canvas-container') ||
                element.classList.contains('drawing-canvas') ||
                element.classList.contains('drawing-section') ||
                element.id === 'drawing-canvas'
            )) {
                return true;
            }
            element = element.parentElement;
        }
        return false;
    }
    
    function showProtectionNotification(actionType = '') {
        const notification = document.getElementById('protection-notification');
        const messageContent = document.getElementById('protection-message-content');
        
        let message = '‚õî Ÿáÿ∞Ÿá ÿßŸÑÿÆÿßÿµŸäÿ© ŸÖÿπÿ∑ŸÑÿ© - ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÖÿ≠ŸÖŸä ÿ®ÿ≠ŸÇŸàŸÇ ÿßŸÑŸÜÿ¥ÿ±';
        
        switch(actionType) {
            case 'rightClick':
                message = '‚õî ÿßŸÑŸÜŸÇÿ± ÿßŸÑÿ£ŸäŸÖŸÜ ŸÖÿπÿ∑ŸÑ ŸÑÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
                break;
            case 'devTools':
                message = '‚õî ÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ∑Ÿàÿ±ŸäŸÜ ŸÖÿπÿ∑ŸÑÿ© ŸÑÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
                break;
            case 'copy':
                message = '‚õî ÿßŸÑŸÜÿ≥ÿÆ ŸÖÿπÿ∑ŸÑ ŸÑÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
                break;
            case 'imageProtection':
                message = '‚õî ÿ≠ŸÅÿ∏ ÿßŸÑÿµŸàÿ± ŸÖÿπÿ∑ŸÑ ŸÑÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ';
                break;
            case 'settingsSaved':
                message = '‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠';
                break;
            default:
                message = actionType || '‚õî Ÿáÿ∞Ÿá ÿßŸÑÿÆÿßÿµŸäÿ© ŸÖÿπÿ∑ŸÑÿ© - ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸÖÿ≠ŸÖŸä ÿ®ÿ≠ŸÇŸàŸÇ ÿßŸÑŸÜÿ¥ÿ±';
        }
        
        messageContent.textContent = message;
        notification.style.display = 'flex';
        
        setTimeout(() => {
            if (notification.style.display === 'flex') {
                notification.style.display = 'none';
            }
        }, 3000);
    }
    
    function closeProtectionNotification() {
        document.getElementById('protection-notification').style.display = 'none';
    }
    
    // ========== ÿßŸÑŸÖÿπÿ±ÿ∂ ÿßŸÑŸÖÿπÿØŸÑ ==========
    function openImg(url) {
        const viewer = document.getElementById('viewer');
        const img = document.getElementById('viewer-img');
        const watermark = document.getElementById('viewer-watermark');
        
        img.src = url;
        watermark.textContent = currentData.wm_text || '';
        viewer.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        document.addEventListener('keydown', handleKeydown);
    }
    
    function closeViewer() {
        const viewer = document.getElementById('viewer');
        viewer.style.display = 'none';
        document.body.style.overflow = 'auto';
        document.removeEventListener('keydown', handleKeydown);
    }
    
    function closeViewerOnOverlay(event) {
        if (event.target.id === 'viewer') {
            closeViewer();
        }
    }
    
    function handleKeydown(e) {
        if (e.key === 'Escape') {
            closeViewer();
        }
    }
    
    // ========== ÿØŸàÿßŸÑ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ==========
    function drawImgs(imgs) { 
        if(!imgs) return '<p style="text-align:center; padding:50px; color:var(--text-secondary); font-size:1.1rem;">ŸÇÿ±Ÿäÿ®ÿßŸã...</p>'; 
        
        const wmTxt = currentData.wm_text || ''; 
        const imgsArray = Object.keys(imgs).reverse();
        
        return imgsArray.map((id, index) => {
            const imgUrl = imgs[id].url;
            
            return `
            <div class="card">
                <div class="img-container" onclick="openImg('${imgUrl}')">
                    <img src="${imgUrl}" 
                         loading="lazy" 
                         onerror="this.onerror=null; this.style.display='none'; this.parentNode.innerHTML='<div style=\\'width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:var(--card); color:var(--text-secondary);\\'><i class=\\'fas fa-image fa-3x\\'></i></div>';">
                    <div class="wm-tag">${wmTxt}</div>
                </div>
                <button onclick="whatsappOrder('${imgUrl}')" class="btn-order">ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±</button>
            </div>
        `}).join(''); 
    }
    
    // ========== ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ Firebase ==========
    db.ref(DB_PATH).on('value', snap => {
        currentData = snap.val() || {}; 
        document.getElementById('splash').style.display = 'none';
        
        const mScreen = document.getElementById('maintenance-screen');
        if (currentData.maintenance_mode && !isAdmin) {
            showMaintenanceScreen();
        } else {
            hideMaintenanceScreen();
        }
        
        initThemeAndFont();
        renderAll(); 
        
        if(currentData.news_bar) { 
            document.getElementById('news-container').style.display='flex'; 
            document.getElementById('news-text').innerText=currentData.news_bar; 
        } else { 
            document.getElementById('news-container').style.display='none'; 
        }
        
        document.getElementById('site-footer').innerText = currentData.footer_text || 'ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ© ¬© ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ± ŸÑŸÑÿØŸäŸÉŸàÿ±';
        document.getElementById('partners-title-text').innerText = currentData.partners_title || '';
        
        startPartnersSlider();
        updateWorkStatus();
        
        if (isAdmin) {
            document.getElementById('protection-toggle').style.display = 'flex';
        }
    }, function(error) {
        console.error("ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:", error);
        document.getElementById('splash').style.display = 'none';
    });
    
    function initThemeAndFont() {
        if (currentData.header_font) {
            setFont(currentData.header_font, false);
        } else {
            setFont('tajawal', false);
        }
    }
    
    function setFont(fontName, saveToFirebase = true) {
        selectedFont = fontName;
        
        let fontFamily;
        switch(fontName) {
            case 'tajawal':
                fontFamily = "'Tajawal', sans-serif";
                break;
            case 'amiri':
                fontFamily = "'Amiri', serif";
                break;
            case 'lateef':
                fontFamily = "'Lateef', serif";
                break;
            case 'almarai':
                fontFamily = "'Almarai', sans-serif";
                break;
            case 'changa':
                fontFamily = "'Changa', sans-serif";
                break;
            case 'lalezar':
                fontFamily = "'Lalezar', cursive";
                break;
            default:
                fontFamily = "'" + fontName + "', sans-serif";
        }
        
        document.documentElement.style.setProperty('--header-font', fontFamily);
        
        if (saveToFirebase) {
            db.ref(DB_PATH).update({ header_font: fontName }).then(() => {
                showProtectionNotification('ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿÆÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠');
            }).catch(error => {
                console.error("ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑÿÆÿ∑:", error);
                showProtectionNotification('ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑÿÆÿ∑');
            });
        }
    }
    
    function selectFont(fontName) {
        setFont(fontName, true);
    }
    
    function selectCustomFont() {
        const customFont = document.getElementById('custom-font-input').value.trim();
        if (customFont) {
            setFont(customFont, true);
            document.getElementById('custom-font-input').value = '';
        } else {
            showProtectionNotification('Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿÆÿ∑ ÿµÿ≠Ÿäÿ≠');
        }
    }
    
    // ========== ÿ¥ÿßÿ¥ÿ© ÿßŸÑÿµŸäÿßŸÜÿ© ==========
    function showMaintenanceScreen() {
        const maintenanceScreen = document.getElementById('maintenance-screen');
        const title = currentData.maintenance_title || 'ÿßŸÑŸÖŸàŸÇÿπ ŸÅŸä ÿµŸäÿßŸÜÿ©';
        const message = currentData.maintenance_message || 'ŸÜÿπŸÖŸÑ ÿπŸÑŸâ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ™ÿ¨ÿ±ÿ®ÿ™ŸÉÿå ÿ≥ŸÜÿπŸàÿØ ŸÇÿ±Ÿäÿ®ÿßŸã ÿ®ÿ•ÿµÿØÿßÿ± ÿ¨ÿØŸäÿØ ŸàŸÖŸÖŸäÿ≤';
        const footer = currentData.maintenance_footer || '¬© ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ± ŸÑŸÑÿØŸäŸÉŸàÿ±';
        
        document.getElementById('maintenance-title').innerText = title;
        document.getElementById('maintenance-message').innerText = message;
        document.getElementById('maintenance-footer').innerText = footer;
        
        maintenanceScreen.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        
        maintenanceScreen.style.opacity = '0';
        setTimeout(() => {
            maintenanceScreen.style.transition = 'opacity 0.5s ease';
            maintenanceScreen.style.opacity = '1';
        }, 10);
    }
    
    function hideMaintenanceScreen() {
        const maintenanceScreen = document.getElementById('maintenance-screen');
        maintenanceScreen.style.opacity = '0';
        setTimeout(() => {
            maintenanceScreen.style.display = 'none';
            document.body.style.overflow = 'auto';
        }, 500);
    }
    
    // ========== ÿßŸÑÿØŸàÿßŸÑ ÿßŸÑÿ∞ŸÉŸäÿ© ŸÑÿπÿ±ÿ∂ ÿßŸÑŸÖŸàÿßÿπŸäÿØ ==========
    function getSmartSchedule(d) {
        if(!d.work_schedule) return "<p style='color:var(--text-secondary); text-align:center;'>ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿØ ŸÖŸàÿßÿπŸäÿØ ÿßŸÑÿπŸÖŸÑ ÿ®ÿπÿØ</p>";
        
        let groups = []; 
        let offDays = [];
        const daysOrder = [6, 0, 1, 2, 3, 4, 5];
        const dayNames = ["ÿßŸÑÿ£ÿ≠ÿØ", "ÿßŸÑÿßÿ´ŸÜŸäŸÜ", "ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°", "ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°", "ÿßŸÑÿÆŸÖŸäÿ≥", "ÿßŸÑÿ¨ŸÖÿπÿ©", "ÿßŸÑÿ≥ÿ®ÿ™"];
        
        daysOrder.forEach((jsDay) => {
            const s = d.work_schedule[jsDay];
            const dayName = dayNames[jsDay];
            
            if(s && s.active) {
                const key = `${s.s1_s || ''}-${s.s1_e || ''}-${s.s2_a || false}-${s.s2_s || ''}-${s.s2_e || ''}`;
                let foundGroup = groups.find(g => g.key === key);
                
                if(foundGroup) {
                    foundGroup.days.push(dayName);
                } else {
                    groups.push({
                        key: key,
                        days: [dayName],
                        data: s
                    });
                }
            } else {
                offDays.push(dayName);
            }
        });
        
        let html = "<div class='schedule-display'>";
        
        groups.forEach(group => {
            let daysText = '';
            if (group.days.length === 1) {
                daysText = group.days[0];
            } else if (group.days.length === 2) {
                daysText = `${group.days[0]} Ÿà ${group.days[1]}`;
            } else {
                daysText = `ŸÖŸÜ ${group.days[0]} ÿ•ŸÑŸâ ${group.days[group.days.length-1]}`;
            }
            
            html += `
            <div class="schedule-group">
                <div class="schedule-days">${daysText}</div>
                <div class="schedule-times">
                    <div class="time-period">
                        <span class="period-label">ÿßŸÑŸÅÿ™ÿ±ÿ© ÿßŸÑÿµÿ®ÿßÿ≠Ÿäÿ©:</span>
                        <span class="time-text">${t12(group.data.s1_s || '09:00')}</span>
                        <span class="time-separator">ÿ•ŸÑŸâ</span>
                        <span class="time-text">${t12(group.data.s1_e || '17:00')}</span>
                    </div>`;
            
            if (group.data.s2_a && group.data.s2_s && group.data.s2_e) {
                html += `
                    <div class="time-period">
                        <span class="period-label">ÿßŸÑŸÅÿ™ÿ±ÿ© ÿßŸÑŸÖÿ≥ÿßÿ¶Ÿäÿ©:</span>
                        <span class="time-text">${t12(group.data.s2_s)}</span>
                        <span class="time-separator">ÿ•ŸÑŸâ</span>
                        <span class="time-text">${t12(group.data.s2_e)}</span>
                    </div>`;
            }
            
            html += `</div></div>`;
        });
        
        if (offDays.length > 0) {
            let offText = '';
            if (offDays.length === 1) {
                offText = offDays[0];
            } else if (offDays.length === 2) {
                offText = `${offDays[0]} Ÿà ${offDays[1]}`;
            } else {
                offText = offDays.join('ÿå ');
            }
            
            html += `<div class="holiday-text">ÿ•ÿ¨ÿßÿ≤ÿ©: ${offText}</div>`;
        }
        
        html += "</div>";
        return html;
    }
    
    function t12(t) { 
        if(!t) return ""; 
        let [h, m] = t.split(':'); 
        h = parseInt(h); 
        return `${h%12||12}:${m}${h>=12?'ŸÖ':'ÿµ'}`; 
    }
    
    function updateWorkStatus() { 
        const d = currentData; 
        if(!d.work_schedule) return; 
        
        const now = new Date();
        const dayJS = now.getDay();
        const schedule = d.work_schedule[dayJS];
        
        let statusHtml = '';
        
        if(schedule && schedule.active) {
            const toMins = (t) => {
                if(!t) return -1;
                const [h, m] = t.split(':').map(Number);
                return (h * 60) + m;
            };
            
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            let isOpen = false;
            
            const morningStart = toMins(schedule.s1_s || '09:00');
            const morningEnd = toMins(schedule.s1_e || '17:00');
            
            if (currentMinutes >= morningStart && currentMinutes < morningEnd) {
                isOpen = true;
            }
            
            if (!isOpen && schedule.s2_a) {
                const eveningStart = toMins(schedule.s2_s);
                const eveningEnd = toMins(schedule.s2_e);
                
                if (currentMinutes >= eveningStart && currentMinutes < eveningEnd) {
                    isOpen = true;
                }
            }
            
            statusHtml = isOpen 
                ? `<div class="status-badge open-glow"><i class="fas fa-circle" style="font-size:0.7rem;"></i> ŸÖŸÅÿ™Ÿàÿ≠ ÿßŸÑÿ¢ŸÜ</div>`
                : `<div class="status-badge closed-glow"><i class="fas fa-circle" style="font-size:0.7rem;"></i> ŸÖÿ∫ŸÑŸÇ ÿßŸÑÿ¢ŸÜ</div>`;
        } else {
            statusHtml = `<div class="status-badge closed-glow" style="background:rgba(231, 76, 60, 0.2); color:var(--red);"><i class="fas fa-circle" style="font-size:0.7rem;"></i> ÿ•ÿ¨ÿßÿ≤ÿ© ÿßŸÑŸäŸàŸÖ</div>`;
        }
        
        const cont = document.getElementById('status-container');
        if(cont) {
            cont.innerHTML = statusHtml;
        }
    }
    
    function startPartnersSlider() {
        const container = document.getElementById('partners-display');
        if(!currentData.partners) { 
            container.innerHTML = '<h2 style="color:var(--gold); font-size:2rem;">ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ±</h2>'; 
            return; 
        }
        const ids = Object.keys(currentData.partners);
        if(ids.length === 0) return;
        let html = ids.map((id, idx) => `<div class="partner-slide" id="partner-${idx}"><img src="${currentData.partners[id].url}" class="partner-img" oncontextmenu="return false;"></div>`).join('');
        container.innerHTML = html;
        const cycle = () => {
            const all = document.querySelectorAll('.partner-slide');
            if(all.length === 0) return;
            all.forEach(el => el.classList.remove('active'));
            const current = document.getElementById(`partner-${partnerIdx}`);
            if(current) current.classList.add('active');
            partnerIdx = (partnerIdx + 1) % ids.length;
        };
        cycle();
        if(window.partnerInterval) clearInterval(window.partnerInterval);
        window.partnerInterval = setInterval(cycle, 4000);
    }
    
    function renderAll() {
        const d = currentData;
        
        let navHtml = `<button class="nav-btn ${currentTab==='home'?'active':''}" onclick="go('home')">ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</button>`;
        navHtml += `<button class="nav-btn ${currentTab==='catalogs'?'active':''}" onclick="go('catalogs')">ÿßŸÑŸÉÿ™ÿßŸÑŸàÿ¨</button>`;
        
        if(d.drawing_active !== false) {
            navHtml += `<button class="nav-btn ${currentTab==='drawing'?'active':''}" onclick="go('drawing')">${d.drawing_button_text || 'ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©'}</button>`;
        }
        
        if(d.pages) Object.keys(d.pages).forEach(id => navHtml += `<button class="nav-btn ${currentTab===id?'active':''}" onclick="go('${id}')">${d.pages[id].title}</button>`);
        navHtml += `<button class="nav-btn ${currentTab==='works'||currentTab.startsWith('alb-')?'active':''}" onclick="go('works')">ÿ£ÿπŸÖÿßŸÑŸÜÿß</button>`;
        document.getElementById('navbar').innerHTML = navHtml;
        
        let aboutBox = (d.about_active) ? `<button class="about-toggle" onclick="toggleAbout('about-box')">ŸÖŸÜ ŸÜÿ≠ŸÜ</button><div id="about-box" class="about-content">${d.about_text || ''}</div>` : '';
        
        let reviewsDisplay = '';
        if(d.reviews) {
            let revItems = Object.keys(d.reviews).map((id, idx) => {
                const r = d.reviews[id];
                return `<div class="review-item" id="rev-${idx}"><div style="color:var(--gold); margin-bottom:5px;">${'‚≠ê'.repeat(r.rating)}</div><p style="font-style:italic; color:var(--text-primary); margin-bottom:5px;">"${r.message}"</p><b style="color:var(--gold); font-size:0.95rem;">- ${r.name}</b></div>`;
            }).join('');
            reviewsDisplay = `<div class="reviews-display-box">${revItems}</div>`;
        }
    
        let workPath = `
            <div style="text-align:center; margin-top:40px;">
                <p style="color:var(--gold); font-weight:900; margin-bottom:25px; font-size:1.8rem;">ŸÖÿ≥ÿßÿ± ÿ±ÿ≠ŸÑÿ™ŸÉ ŸÖÿπŸÜÿß</p>
                <div class="work-path-container">
                    <div class="path-step"><i class="fas fa-comments"></i><h4>ÿßŸÑÿßÿ≥ÿ™ÿ¥ÿßÿ±ÿ©</h4><p>ŸÜÿ≥ŸÖÿπ ÿ£ŸÅŸÉÿßÿ±ŸÉ ŸàŸÜÿ±ÿ≥ŸÖ ÿßŸÑÿ™ÿµŸàÿ± ÿßŸÑÿ£ŸàŸÑŸä ŸÑŸÖÿ≥ÿßÿ≠ÿ™ŸÉ</p></div>
                    <div class="path-step"><i class="fas fa-ruler-combined"></i><h4>ÿßŸÑŸÖÿπÿßŸäŸÜÿ©</h4><p>ÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑŸÖŸàŸÇÿπ Ÿàÿ±ŸÅÿπ ÿßŸÑŸÖŸÇÿßÿ≥ÿßÿ™ ÿ®ÿØŸÇÿ© ŸÖÿ™ŸÜÿßŸáŸäÿ©</p></div>
                    <div class="path-step"><i class="fas fa-pencil-ruler"></i><h4>ÿßŸÑÿ™ÿµŸÖŸäŸÖ</h4><p>ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿÆŸäÿßŸÑ ŸÑŸàÿßŸÇÿπ ÿπÿ®ÿ± ŸÜŸÖÿßÿ∞ÿ¨ ÿßÿ≠ÿ™ÿ±ÿßŸÅŸäÿ©</p></div>
                    <div class="path-step"><i class="fas fa-hammer"></i><h4>ÿßŸÑÿ™ŸÜŸÅŸäÿ∞</h4><p>ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ™ÿµŸÖŸäŸÖ ÿ®ÿ£ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ÿßŸÑÿ¨ŸàÿØÿ© Ÿàÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ±</p></div>
                </div>
            </div>`;
    
        let reviewForm = `<button class="about-toggle" onclick="toggleAbout('review-box')">ÿ£ÿ∂ŸÅ ÿ™ŸÇŸäŸäŸÖ</button><div id="review-box" class="about-content"><div id="review-form-container"><input type="text" id="rev-name" placeholder="ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿ±ŸäŸÖ"><div class="rating-stars" id="star-row" style="display:flex; gap:5px; justify-content:center; margin-bottom:10px; direction:ltr;"><i class="fas fa-star" onclick="setStar(5)"></i><i class="fas fa-star" onclick="setStar(4)"></i><i class="fas fa-star" onclick="setStar(3)"></i><i class="fas fa-star" onclick="setStar(2)"></i><i class="fas fa-star" onclick="setStar(1)"></i></div><textarea id="rev-msg" placeholder="ÿßŸÉÿ™ÿ® ÿ™ÿ¨ÿ±ÿ®ÿ™ŸÉ ŸáŸÜÿß..."></textarea><button onclick="submitReview()" style="width:100%; background:var(--gold); border:none; padding:12px; border-radius:var(--radius-sm); font-weight:900; color:#000;">ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ™ŸÇŸäŸäŸÖ</button></div></div>`;
    
        let locationButton = '';
        if(d.location_url) {
            locationButton = `<button onclick="window.open('${d.location_url}', '_blank')" class="location-btn"><i class="fas fa-map-marker-alt"></i> ŸÖŸàŸÇÿπŸÜÿß ÿπŸÑŸâ ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ©</button>`;
        }
    
        let mainContent = `<section class="sec ${currentTab==='home'?'active':''}">
            <div style="text-align:center;">
                ${aboutBox}
                ${reviewForm}
                ${reviewsDisplay}
                ${workPath}
                <div class="schedule-container">
                    <p class="schedule-title">üïí ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿπŸÖŸÑ</p>
                    <div style="margin-bottom:20px; line-height:1.7;">
                        ${getSmartSchedule(d)}
                    </div>
                    
                    <div class="status-location-container">
                        <div id="status-container"></div>
                        ${locationButton}
                    </div>
                </div>
                <button onclick="whatsappGlobal()" class="whatsapp-btn">ÿ™ŸàÿßÿµŸÑ ŸÖÿπŸÜÿß <i class="fab fa-whatsapp"></i></button>
                <div class="social-icons">
                    ${d.insta_url ? `<a href="${d.insta_url}" target="_blank"><i class="fab fa-instagram"></i></a>`:''}
                    ${d.tiktok_url ? `<a href="${d.tiktok_url}" target="_blank"><i class="fab fa-tiktok"></i></a>`:''}
                    ${d.snap_url ? `<a href="${d.snap_url}" target="_blank"><i class="fab fa-snapchat"></i></a>`:''}
                </div>
            </div>
        </section>`;
        
        let contentHtml = mainContent;
        
        contentHtml += `<section class="sec ${currentTab==='catalogs'?'active':''}"><div class="grid">${drawFolders(d.catalogs, 'cat')}</div></section>`;
        
        // ÿ•ÿ∂ÿßŸÅÿ© ŸÇÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸÜ
        if(d.drawing_active !== false) {
            contentHtml += `
            <section class="sec ${currentTab==='drawing'?'active':''}">
                <div class="drawing-section">
                    <h2 class="drawing-title">${d.drawing_title || 'ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©'}</h2>
                    
                    <div class="drawing-description">
                        ${d.drawing_description || 'ŸäŸÖŸÉŸÜŸÉ ŸáŸÜÿß ÿ±ÿ≥ŸÖ ŸÅŸÉÿ±ÿ™ŸÉ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ®Ÿäÿ© ŸÑŸÑÿ™ÿµŸÖŸäŸÖ. ÿßÿ±ÿ≥ŸÖ ŸÖÿß Ÿäÿ¨ŸàŸÑ ÿ®ÿÆÿßÿ∑ÿ±ŸÉ Ÿàÿ≥ŸÜŸÇŸàŸÖ ÿ®ÿ™ÿ≠ŸàŸäŸÑŸá ÿ•ŸÑŸâ ŸàÿßŸÇÿπ!'}
                    </div>
                    
                    <!-- ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© -->
                    <div class="drawing-tools-container">
                        <div class="tool-section">
                            <div class="tool-section-title">
                                <i class="fas fa-pen"></i>
                                <span>ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ±ÿ≥ŸÖ</span>
                            </div>
                            <div class="drawing-tools-row">
                                <button class="tool-btn active" id="pen-tool" onclick="setActiveTool('pen')">
                                    <i class="fas fa-pen"></i> ŸÇŸÑŸÖ
                                </button>
                                <button class="tool-btn" id="eraser-tool" onclick="setActiveTool('eraser')">
                                    <i class="fas fa-eraser"></i> ŸÖŸÖÿ≠ÿßÿ©
                                </button>
                            </div>
                        </div>
                        
                        <div class="tool-section">
                            <div class="tool-section-title">
                                <i class="fas fa-shapes"></i>
                                <span>ÿßŸÑÿ£ÿ¥ŸÉÿßŸÑ</span>
                            </div>
                            <div class="shape-tools">
                                <button class="shape-btn" id="rect-tool" onclick="setActiveTool('rect')" title="ŸÖÿ≥ÿ™ÿ∑ŸäŸÑ">
                                    <i class="fas fa-square"></i>
                                </button>
                                <button class="shape-btn" id="circle-tool" onclick="setActiveTool('circle')" title="ÿØÿßÿ¶ÿ±ÿ©">
                                    <i class="fas fa-circle"></i>
                                </button>
                                <button class="shape-btn" id="line-tool" onclick="setActiveTool('line')" title="ÿÆÿ∑">
                                    <i class="fas fa-slash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="tool-section">
                            <div class="tool-section-title">
                                <i class="fas fa-palette"></i>
                                <span>ÿßŸÑÿ£ŸÑŸàÿßŸÜ</span>
                            </div>
                            <div class="color-palette-drawing">
                                <div class="color-dot selected" data-color="#000000" style="background:#000;" onclick="selectColor('#000000')"></div>
                                <div class="color-dot" data-color="#c5a059" style="background:#c5a059;" onclick="selectColor('#c5a059')"></div>
                                <div class="color-dot" data-color="#e74c3c" style="background:#e74c3c;" onclick="selectColor('#e74c3c')"></div>
                                <div class="color-dot" data-color="#2ecc71" style="background:#2ecc71;" onclick="selectColor('#2ecc71')"></div>
                                <div class="color-dot" data-color="#3498db" style="background:#3498db;" onclick="selectColor('#3498db')"></div>
                                <div class="color-dot" data-color="#9b59b6" style="background:#9b59b6;" onclick="selectColor('#9b59b6')"></div>
                                <div class="color-dot" data-color="#f1c40f" style="background:#f1c40f;" onclick="selectColor('#f1c40f')"></div>
                                <div class="color-dot" data-color="#ffffff" style="background:#ffffff; border:1px solid #ccc;" onclick="selectColor('#ffffff')"></div>
                            </div>
                        </div>
                        
                        <div class="tool-section">
                            <div class="tool-section-title">
                                <i class="fas fa-brush"></i>
                                <span>ÿ≠ÿ¨ŸÖ ÿßŸÑŸÅÿ±ÿ¥ÿßÿ©</span>
                            </div>
                            <div class="brush-size-control">
                                <label>
                                    <span>ÿßŸÑÿ≠ÿ¨ŸÖ:</span>
                                    <span id="brush-size-value" class="brush-size-display">5</span>
                                </label>
                                <input type="range" id="brush-size" class="brush-size-slider" min="1" max="50" value="5" oninput="updateBrushSize(this.value)">
                            </div>
                        </div>
                    </div>
                    
                    <!-- ŸÑŸàÿ≠ÿ© ÿßŸÑÿ±ÿ≥ŸÖ -->
                    <div class="drawing-canvas-container">
                        <canvas id="drawing-canvas" class="drawing-canvas" width="1100" height="500"></canvas>
                        <div class="drawing-welcome" id="drawing-welcome">
                            <i class="fas fa-paint-brush"></i>
                            <div>ÿßÿ®ÿØÿ£ ÿßŸÑÿ±ÿ≥ŸÖ ŸáŸÜÿß...</div>
                            <div style="font-size:0.9rem; margin-top:10px; color:#777;">ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ£ÿØŸàÿßÿ™ ÿ£ÿπŸÑÿßŸá ŸÑŸÑÿ±ÿ≥ŸÖ</div>
                        </div>
                    </div>
                    
                    <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ -->
                    <div class="canvas-controls">
                        <button onclick="saveDrawingToWhatsApp()" class="drawing-action-btn whatsapp">
                            <i class="fab fa-whatsapp"></i> ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ŸÖ ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ®
                        </button>
                        
                        <button onclick="downloadDrawing()" class="drawing-action-btn download">
                            <i class="fas fa-download"></i> ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ŸÖ
                        </button>
                        
                        <button onclick="clearDrawingCanvas()" class="drawing-action-btn clear">
                            <i class="fas fa-trash"></i> ŸÖÿ≥ÿ≠ ÿßŸÑŸÉŸÑ
                        </button>
                    </div>
                    
                    <div class="drawing-info">
                        <i class="fas fa-info-circle"></i> 
                        ÿßŸÑÿ±ÿ≥ŸÖ ÿ∫Ÿäÿ± ŸÖÿÆÿ≤ŸÜ ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπÿå ŸÅŸáŸà ÿÆÿßÿµ ÿ®ŸÉ ŸÅŸÇÿ∑. ŸäŸÖŸÉŸÜŸÉ ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ŸÖ Ÿàÿ•ÿ±ÿ≥ÿßŸÑŸá ÿ•ŸÑŸäŸÜÿß ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ® ŸÑŸÑŸÖŸÜÿßŸÇÿ¥ÿ©
                    </div>
                </div>
            </section>`;
        }
        
        if(d.pages) Object.keys(d.pages).forEach(id => contentHtml += `<section class="sec ${currentTab===id?'active':''}"><div class="grid">${drawImgs(d.pages[id].imgs)}</div></section>`);
        contentHtml += `<section class="sec ${currentTab==='works'?'active':''}"><div class="grid">${drawAlbums(d.albums)}</div></section>`;
        if(d.albums) Object.keys(d.albums).forEach(id => contentHtml += `<section class="sec ${currentTab==='alb-'+id?'active':''}"><button onclick="go('works')" style="color:var(--gold); background:none; border:none; margin-bottom:20px; font-weight:bold; font-size:1.1rem;"><i class="fas fa-arrow-right"></i> ÿπŸàÿØÿ© ŸÑŸÑÿ£ÿπŸÖÿßŸÑ</button><div class="grid">${drawImgs(d.albums[id].imgs)}</div></section>`);
        
        document.getElementById('content-area').innerHTML = contentHtml;
        updateWorkStatus(); 
        
        // ÿ™ŸáŸäÿ¶ÿ© ŸÑŸàÿ≠ÿ© ÿßŸÑÿ±ÿ≥ŸÖ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÇÿ≥ŸÖ ÿßŸÑÿ≠ÿßŸÑŸä ŸáŸà ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©
        if(currentTab === 'drawing') {
            setTimeout(initDrawingCanvas, 300);
            setupDrawingToolEvents();
        }
    }
    
    function drawAlbums(albs) { 
        if(!albs) return ''; 
        return Object.keys(albs).map(id => `
            <div class="card" onclick="go('alb-${id}')" style="padding:40px; text-align:center; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:180px;">
                <i class="fas fa-folder" style="font-size:3rem; color:var(--gold); margin-bottom:15px;"></i>
                <h3 style="color:var(--gold); font-size:1.3rem;">${albs[id].name}</h3>
            </div>
        `).join(''); 
    }
    
    function drawFolders(obj, type) { 
        if(!obj) return '<p style="text-align:center; padding:50px; color:var(--text-secondary); font-size:1.1rem;">ŸÇÿ±Ÿäÿ®ÿßŸã...</p>'; 
        return Object.keys(obj).map(id => `
            <div class="card" onclick="openCat('${id}')" style="padding:40px; text-align:center; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:180px;">
                <i class="fas fa-book" style="font-size:3rem; color:var(--gold); margin-bottom:15px;"></i>
                <h3 style="color:var(--gold); font-size:1.3rem;">${obj[id].name}</h3>
            </div>
        `).join(''); 
    }
    
    function toggleCol(id) { 
        document.querySelectorAll('.collapse-content').forEach(c=> { 
            if(c.id!==id) c.style.display='none'; 
        }); 
        const el = document.getElementById(id); 
        el.style.display = el.style.display==='block'?'none':'block'; 
    }
    
    function toggleAbout(id) { 
        document.getElementById(id).classList.toggle('open'); 
    }
    
    function go(id) { 
        currentTab=id; 
        renderAll(); 
        window.scrollTo(0,0); 
    }
    
    function whatsappGlobal() { 
        window.open(`https://wa.me/${currentData.whatsapp_num}?text=${encodeURIComponent('ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖÿå ÿ£ŸàÿØ ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿ®ÿµŸÖÿ© ÿ∫Ÿäÿ± ŸÑŸÑÿØŸäŸÉŸàÿ±.')}`, '_blank'); 
    }
    
    function whatsappOrder(url) { 
        window.open(`https://wa.me/${currentData.whatsapp_num}?text=${encodeURIComponent('ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖÿå ÿ£ŸàÿØ ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ™ÿµŸÖŸäŸÖ:\n'+url)}`, '_blank'); 
    }
    
    function openCat(id) { 
        document.getElementById('cat-frame').innerHTML = currentData.catalogs[id].code; 
        document.getElementById('cat-overlay').style.display='flex'; 
    }
    
    // ========== ÿØŸàÿßŸÑ ÿßŸÑÿ•ÿØÿßÿ±ÿ© ==========
    function setStar(n) { 
        userRating = n; 
        const stars = document.querySelectorAll('#star-row i'); 
        stars.forEach((s, i) => { 
            if (5 - i <= n) s.style.color = 'var(--gold)'; 
            else s.style.color = '#333'; 
        }); 
    }
    
    function submitReview() { 
        if(localStorage.getItem('v28_voted')) return showProtectionNotification('ŸÑŸÇÿØ ŸÇŸÖÿ™ ÿ®ÿßŸÑÿ™ŸÇŸäŸäŸÖ ŸÖÿ≥ÿ®ŸÇÿßŸã'); 
        const name = document.getElementById('rev-name').value; 
        const msg = document.getElementById('rev-msg').value; 
        if(!name || !msg || userRating === 0) return showProtectionNotification('Ÿäÿ±ÿ¨Ÿâ ÿ•ŸÉŸÖÿßŸÑ ÿ¨ŸÖŸäÿπ ÿ≠ŸÇŸàŸÑ ÿßŸÑÿ™ŸÇŸäŸäŸÖ'); 
        db.ref(DB_PATH + '/reviews').push({ 
            name: name, 
            message: msg, 
            rating: userRating, 
            date: new Date().toLocaleDateString('ar-SA') 
        }).then(() => { 
            localStorage.setItem('v28_voted', 'true'); 
            showProtectionNotification('ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ™ŸÇŸäŸäŸÖŸÉ!');
            renderAll(); 
        }).catch(error => {
            console.error("ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ™ŸÇŸäŸäŸÖ:", error);
            showProtectionNotification('ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ™ŸÇŸäŸäŸÖ');
        }); 
    }
    
    function saveSettings() { 
        db.ref(DB_PATH).update({ 
            site_name: document.getElementById('in-name').value, 
            whatsapp_num: document.getElementById('in-wa').value, 
            wm_text: document.getElementById('in-wm').value, 
            news_bar: document.getElementById('in-news').value, 
            footer_text: document.getElementById('in-footer').value 
        }).then(() => {
            showProtectionNotification('settingsSaved');
        }).catch(error => {
            console.error("ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™:", error);
            showProtectionNotification('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ≠ŸÅÿ∏');
        }); 
    }
    
    function saveDrawingSettings() {
        db.ref(DB_PATH).update({
            drawing_active: document.getElementById('enable-drawing-section').checked,
            drawing_title: document.getElementById('drawing-title-input').value,
            drawing_description: document.getElementById('drawing-description-input').value,
            drawing_button_text: document.getElementById('drawing-button-text').value,
            drawing_whatsapp_message: document.getElementById('drawing-whatsapp-message').value
        }).then(() => {
            showProtectionNotification('‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©');
            renderAll();
        }).catch(error => {
            console.error("ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©:", error);
            showProtectionNotification('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ≠ŸÅÿ∏');
        });
    }
    
    function saveProtectionSettings() {
        protectionSettings = {
            rightClick: document.getElementById('enable-right-click-protection').checked,
            keyboardShortcuts: document.getElementById('enable-keyboard-protection').checked,
            imageProtection: document.getElementById('enable-image-protection').checked,
            textSelection: document.getElementById('enable-selection-protection').checked,
            drawingExemption: document.getElementById('enable-drawing-exemption').checked
        };
        
        isDrawingExempted = protectionSettings.drawingExemption;
        
        const message = document.getElementById('protection-message-text').value;
        
        db.ref(DB_PATH).update({
            protection_settings: protectionSettings,
            protection_message: message
        }).then(() => {
            showProtectionNotification('‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ©');
            
            if (isProtectionEnabled) {
                disableProtection();
                enableProtection();
            }
        }).catch(error => {
            console.error("ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ©:", error);
            showProtectionNotification('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ≠ŸÅÿ∏');
        });
    }
    
    function fillAdminFields() { 
        const d = currentData; 
        document.getElementById('in-name').value = d.site_name || ''; 
        document.getElementById('in-wa').value = d.whatsapp_num || ''; 
        document.getElementById('in-wm').value = d.wm_text || ''; 
        document.getElementById('in-news').value = d.news_bar || ''; 
        document.getElementById('in-footer').value = d.footer_text || ''; 
        
        // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≠ŸÖÿßŸäÿ©
        if (d.protection_settings) {
            protectionSettings = d.protection_settings;
            document.getElementById('enable-right-click-protection').checked = protectionSettings.rightClick !== false;
            document.getElementById('enable-keyboard-protection').checked = protectionSettings.keyboardShortcuts !== false;
            document.getElementById('enable-image-protection').checked = protectionSettings.imageProtection !== false;
            document.getElementById('enable-selection-protection').checked = protectionSettings.textSelection !== false;
            document.getElementById('enable-drawing-exemption').checked = protectionSettings.drawingExemption !== false;
            isDrawingExempted = protectionSettings.drawingExemption !== false;
        }
        
        if (d.protection_message) {
            document.getElementById('protection-message-text').value = d.protection_message;
        }
        
        // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©
        document.getElementById('drawing-title-input').value = d.drawing_title || 'ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©';
        document.getElementById('drawing-description-input').value = d.drawing_description || 'ŸäŸÖŸÉŸÜŸÉ ŸáŸÜÿß ÿ±ÿ≥ŸÖ ŸÅŸÉÿ±ÿ™ŸÉ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ®Ÿäÿ© ŸÑŸÑÿ™ÿµŸÖŸäŸÖ. ÿßÿ±ÿ≥ŸÖ ŸÖÿß Ÿäÿ¨ŸàŸÑ ÿ®ÿÆÿßÿ∑ÿ±ŸÉ Ÿàÿ≥ŸÜŸÇŸàŸÖ ÿ®ÿ™ÿ≠ŸàŸäŸÑŸá ÿ•ŸÑŸâ ŸàÿßŸÇÿπ!';
        document.getElementById('drawing-button-text').value = d.drawing_button_text || 'ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ©';
        document.getElementById('drawing-whatsapp-message').value = d.drawing_whatsapp_message || 'ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖÿå ÿ£ŸàÿØ ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑Ÿä:';
        document.getElementById('enable-drawing-section').checked = d.drawing_active !== false;
    }
    
    // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ≠ÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸÜ ==========
    function initDrawingCanvas() {
        drawingCanvas = document.getElementById('drawing-canvas');
        if (!drawingCanvas) {
            console.error('Canvas not found');
            return;
        }
        
        drawingCtx = drawingCanvas.getContext('2d');
        
        // ÿ™ÿπŸäŸäŸÜ ÿ≠ÿ¨ŸÖ ÿßŸÑŸÑŸàÿ≠ÿ©
        const container = drawingCanvas.parentElement;
        const rect = container.getBoundingClientRect();
        drawingCanvas.width = rect.width;
        drawingCanvas.height = 500;
        
        // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
        drawingCtx.lineCap = 'round';
        drawingCtx.lineJoin = 'round';
        drawingCtx.strokeStyle = currentDrawingColor;
        drawingCtx.lineWidth = currentBrushSize;
        drawingCtx.fillStyle = '#f9f9f9';
        drawingCtx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);
        
        // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÖÿßŸàÿ≥
        setupCanvasEvents();
        
        console.log('Canvas initialized successfully');
    }
    
    function setupDrawingToolEvents() {
        // ÿ•ÿπÿØÿßÿØ ÿ£ÿ≠ÿØÿßÿ´ ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ±ÿ≥ŸÖ
        document.getElementById('pen-tool').addEventListener('click', function() {
            setActiveTool('pen');
        });
        
        document.getElementById('eraser-tool').addEventListener('click', function() {
            setActiveTool('eraser');
        });
        
        document.getElementById('rect-tool').addEventListener('click', function() {
            setActiveTool('rect');
        });
        
        document.getElementById('circle-tool').addEventListener('click', function() {
            setActiveTool('circle');
        });
        
        document.getElementById('line-tool').addEventListener('click', function() {
            setActiveTool('line');
        });
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿ¨ŸÖ ÿßŸÑŸÅÿ±ÿ¥ÿßÿ©
        document.getElementById('brush-size').addEventListener('input', function() {
            updateBrushSize(this.value);
        });
    }
    
    function setupCanvasEvents() {
        // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÇÿØŸäŸÖÿ© ÿ£ŸàŸÑÿßŸã
        drawingCanvas.removeEventListener('mousedown', startDrawing);
        drawingCanvas.removeEventListener('mousemove', draw);
        drawingCanvas.removeEventListener('mouseup', stopDrawing);
        drawingCanvas.removeEventListener('mouseout', stopDrawing);
        
        // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≠ÿØÿßÿ´ ÿ¨ÿØŸäÿØÿ©
        drawingCanvas.addEventListener('mousedown', startDrawing);
        drawingCanvas.addEventListener('mousemove', draw);
        drawingCanvas.addEventListener('mouseup', stopDrawing);
        drawingCanvas.addEventListener('mouseout', stopDrawing);
        
        // ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÑŸÖÿ≥ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ©
        drawingCanvas.addEventListener('touchstart', function(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY,
                bubbles: true,
                cancelable: true
            });
            drawingCanvas.dispatchEvent(mouseEvent);
        }, {passive: false});
        
        drawingCanvas.addEventListener('touchmove', function(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY,
                bubbles: true,
                cancelable: true
            });
            drawingCanvas.dispatchEvent(mouseEvent);
        }, {passive: false});
        
        drawingCanvas.addEventListener('touchend', function(e) {
            e.preventDefault();
            const mouseEvent = new MouseEvent('mouseup', {
                bubbles: true,
                cancelable: true
            });
            drawingCanvas.dispatchEvent(mouseEvent);
        }, {passive: false});
        
        // ŸÖŸÜÿπ ÿßŸÑÿ≥ŸÑŸàŸÉ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
        drawingCanvas.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
    }
    
    function startDrawing(e) {
        e.preventDefault();
        isDrawing = true;
        const rect = drawingCanvas.getBoundingClientRect();
        lastX = e.clientX - rect.left;
        lastY = e.clientY - rect.top;
        
        if (currentShape) {
            isDrawingShape = true;
            startX = lastX;
            startY = lastY;
            
            // ÿ≠ŸÅÿ∏ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑŸàÿ≠ÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
            savedCanvasState = drawingCanvas.toDataURL();
        } else {
            drawingCtx.beginPath();
            drawingCtx.moveTo(lastX, lastY);
        }
        
        // ÿ•ÿÆŸÅÿßÿ° ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ™ÿ±ÿ≠Ÿäÿ®
        document.getElementById('drawing-welcome').style.display = 'none';
        
        return false;
    }
    
    function draw(e) {
        if (!isDrawing) return;
        e.preventDefault();
        
        const rect = drawingCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        if (isDrawingShape) {
            // ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ©
            const img = new Image();
            img.onload = function() {
                drawingCtx.clearRect(0, 0, drawingCanvas.width, drawingCanvas.height);
                drawingCtx.fillStyle = '#f9f9f9';
                drawingCtx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);
                drawingCtx.drawImage(img, 0, 0);
                
                // ÿ±ÿ≥ŸÖ ÿßŸÑÿ¥ŸÉŸÑ ÿßŸÑŸÖÿ§ŸÇÿ™
                drawingCtx.beginPath();
                drawingCtx.strokeStyle = currentDrawingColor;
                drawingCtx.lineWidth = currentBrushSize;
                
                if (currentShape === 'rect') {
                    const width = x - startX;
                    const height = y - startY;
                    drawingCtx.rect(startX, startY, width, height);
                } else if (currentShape === 'circle') {
                    const radius = Math.sqrt(Math.pow(x - startX, 2) + Math.pow(y - startY, 2));
                    drawingCtx.arc(startX, startY, radius, 0, Math.PI * 2);
                } else if (currentShape === 'line') {
                    drawingCtx.moveTo(startX, startY);
                    drawingCtx.lineTo(x, y);
                }
                
                drawingCtx.stroke();
            };
            img.src = savedCanvasState;
        } else {
            drawingCtx.lineTo(x, y);
            drawingCtx.stroke();
            [lastX, lastY] = [x, y];
        }
        
        return false;
    }
    
    function stopDrawing() {
        if (!isDrawing) return;
        
        if (isDrawingShape) {
            isDrawingShape = false;
            savedCanvasState = drawingCanvas.toDataURL();
        }
        
        isDrawing = false;
        drawingCtx.beginPath();
    }
    
    function setActiveTool(tool) {
        currentDrawingTool = tool;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ£ÿØŸàÿßÿ™
        document.querySelectorAll('.tool-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        document.querySelectorAll('.shape-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        if (tool === 'pen') {
            document.getElementById('pen-tool').classList.add('active');
            drawingCtx.strokeStyle = currentDrawingColor;
            drawingCtx.lineWidth = currentBrushSize;
            currentShape = '';
        } else if (tool === 'eraser') {
            document.getElementById('eraser-tool').classList.add('active');
            drawingCtx.strokeStyle = '#f9f9f9';
            drawingCtx.lineWidth = currentBrushSize * 2;
            currentShape = '';
        } else if (tool === 'rect') {
            document.getElementById('rect-tool').classList.add('active');
            currentShape = 'rect';
        } else if (tool === 'circle') {
            document.getElementById('circle-tool').classList.add('active');
            currentShape = 'circle';
        } else if (tool === 'line') {
            document.getElementById('line-tool').classList.add('active');
            currentShape = 'line';
        }
    }
    
    function selectColor(color) {
        currentDrawingColor = color;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿ≠ÿØÿØÿ©
        document.querySelectorAll('.color-dot').forEach(dot => {
            dot.classList.remove('selected');
        });
        event.target.classList.add('selected');
        
        if (currentDrawingTool === 'pen') {
            drawingCtx.strokeStyle = color;
        }
    }
    
    function updateBrushSize(size) {
        currentBrushSize = parseInt(size);
        document.getElementById('brush-size-value').textContent = size;
        document.getElementById('brush-size-value').style.width = currentBrushSize + 'px';
        document.getElementById('brush-size-value').style.height = currentBrushSize + 'px';
        
        if (currentDrawingTool === 'pen') {
            drawingCtx.lineWidth = currentBrushSize;
        } else if (currentDrawingTool === 'eraser') {
            drawingCtx.lineWidth = currentBrushSize * 2;
        }
    }
    
    function clearDrawingCanvas() {
        if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖÿ≥ÿ≠ ÿßŸÑÿ±ÿ≥ŸÖ ÿ®ÿßŸÑŸÉÿßŸÖŸÑÿü')) {
            drawingCtx.fillStyle = '#f9f9f9';
            drawingCtx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);
            savedCanvasState = drawingCanvas.toDataURL();
            document.getElementById('drawing-welcome').style.display = 'block';
        }
    }
    
    function saveDrawingToWhatsApp() {
        if (isCanvasEmpty()) {
            alert('ÿßŸÑÿ±ÿ≥ŸÖ ŸÅÿßÿ±ÿ∫ÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ±ÿ≥ŸÖ ÿ£ŸàŸÑÿßŸã');
            return;
        }
        
        const message = encodeURIComponent(currentData.drawing_whatsapp_message || 'ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖÿå ÿ£ŸàÿØ ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑Ÿä:');
        const whatsappNum = currentData.whatsapp_num || '966500000000';
        
        const instruction = `
        üì± ÿÆÿ∑Ÿàÿßÿ™ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ŸÖ:
        
        1. ÿßÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿ≤ÿ± "ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ŸÖ" ÿ£ŸàŸÑÿßŸã
        2. ÿßŸÜÿ™ŸÇŸÑ ÿ•ŸÑŸâ Ÿàÿßÿ™ÿ≥ÿßÿ®
        3. ÿ£ÿ±ÿ≥ŸÑ ŸÑŸÜÿß ÿßŸÑÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ© ŸÖÿπ ÿ¥ÿ±ÿ≠ ŸÑŸÅŸÉÿ±ÿ™ŸÉ
        
        ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ´ŸÇÿ™ŸÉ ÿ®ŸÜÿß! ‚ú®
        `;
        
        if (confirm(instruction)) {
            window.open(`https://wa.me/${whatsappNum}?text=${message}`, '_blank');
        }
    }
    
    function downloadDrawing() {
        if (isCanvasEmpty()) {
            alert('ÿßŸÑÿ±ÿ≥ŸÖ ŸÅÿßÿ±ÿ∫ÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ±ÿ≥ŸÖ ÿ£ŸàŸÑÿßŸã');
            return;
        }
        
        const link = document.createElement('a');
        link.download = `ÿ™ÿµŸÖŸäŸÖ-ÿ®ÿµŸÖÿ©-ÿ∫Ÿäÿ±-${Date.now()}.png`;
        link.href = drawingCanvas.toDataURL('image/png');
        link.click();
        
        alert('‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ŸÖ ÿ®ŸÜÿ¨ÿßÿ≠');
    }
    
    function isCanvasEmpty() {
        if (!drawingCanvas) return true;
        
        const blank = document.createElement('canvas');
        blank.width = drawingCanvas.width;
        blank.height = drawingCanvas.height;
        const blankCtx = blank.getContext('2d');
        blankCtx.fillStyle = '#f9f9f9';
        blankCtx.fillRect(0, 0, blank.width, blank.height);
        
        return drawingCanvas.toDataURL() === blank.toDataURL();
    }
    
    // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿπŸÖŸÑ ŸÉŸÑ ÿØŸÇŸäŸÇÿ©
    setInterval(updateWorkStatus, 60000);
</script>
</body>
</html>
