<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>بصمة غير للديكور</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- إضافة الخطوط العربية -->
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&family=Tajawal:wght@300;400;500;700;800&family=Almarai:wght@300;400;700;800&family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* ========== إعادة التعريف الكاملة ========== */
        :root {
            /* الألوان الجديدة */
            --primary: #2a6b7f;
            --primary-dark: #1d4d5c;
            --primary-light: #3a8ca3;
            --accent: #e6b325;
            --accent-dark: #c99a1d;
            --accent-light: #f0c955;
            
            /* الألوان المحايدة */
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #a0a0a0;
            --gray-dark: #343a40;
            
            /* الخلفيات */
            --bg-main: #0a0a0f;
            --bg-card: rgba(20, 25, 30, 0.95);
            --bg-nav: rgba(15, 20, 25, 0.98);
            --bg-overlay: rgba(0, 0, 0, 0.85);
            
            /* الظلال */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.15);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.25);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.35);
            --shadow-gold: 0 0 20px rgba(230, 179, 37, 0.3);
            
            /* الحدود */
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 24px;
            --border-color: rgba(255, 255, 255, 0.1);
            --border-accent: rgba(230, 179, 37, 0.3);
            
            /* التدرجات */
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
            --gradient-dark: linear-gradient(135deg, var(--dark) 0%, var(--darker) 100%);
            --gradient-card: linear-gradient(135deg, rgba(20, 25, 30, 0.9) 0%, rgba(15, 20, 25, 0.95) 100%);
            
            /* الخطوط */
            --font-heading: 'El Messiri', 'Cairo', sans-serif;
            --font-body: 'Tajawal', 'Almarai', sans-serif;
            --font-accent: 'Cairo', sans-serif;
            
            /* الأنيميشن */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* إعادة التعيين */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        img {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            pointer-events: none;
        }
        
        /* استثناءات ضرورية */
        #viewer-img,
        .admin-box img,
        .drawing-canvas,
        input,
        textarea,
        button,
        select {
            pointer-events: auto;
        }
        
        /* الهيكل الأساسي */
        body {
            font-family: var(--font-body);
            background: var(--bg-main);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* شاشة التحميل */
        #splash {
            position: fixed;
            inset: 0;
            background: var(--darker);
            z-index: 99999999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 30px;
        }
        
        .splash-logo {
            width: 120px;
            height: 120px;
            background: var(--gradient-accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
            box-shadow: var(--shadow-gold);
        }
        
        .splash-logo i {
            font-size: 3.5rem;
            color: var(--dark);
        }
        
        .splash-text {
            font-family: var(--font-heading);
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--accent) 0%, #fff 50%, var(--accent-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            text-align: center;
        }
        
        .splash-subtext {
            color: var(--gray-light);
            font-size: 1rem;
            text-align: center;
            animation: fadeInOut 2s infinite;
        }
        
        /* شريط التنقل العلوي */
        .top-bar {
            background: var(--gradient-dark);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-accent);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-icon i {
            color: var(--dark);
            font-size: 1.5rem;
        }
        
        .logo-text {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent) 0%, #fff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .top-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        /* قسم الشركاء الجديد */
        .partners-section {
            padding: 60px 20px;
            background: linear-gradient(135deg, rgba(10, 15, 25, 0.9) 0%, rgba(15, 20, 30, 0.95) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .section-title {
            font-family: var(--font-heading);
            font-size: 2rem;
            font-weight: 700;
            color: var(--light);
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: var(--gradient-accent);
            border-radius: 2px;
        }
        
        .section-subtitle {
            color: var(--gray-light);
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .partners-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .partner-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-color);
            transition: var(--transition-normal);
            min-height: 120px;
        }
        
        .partner-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: var(--shadow-gold);
        }
        
        .partner-logo {
            max-width: 100%;
            max-height: 60px;
            filter: grayscale(1);
            transition: var(--transition-normal);
        }
        
        .partner-card:hover .partner-logo {
            filter: grayscale(0);
        }
        
        /* التنقل الرئيسي */
        .main-nav {
            background: var(--bg-nav);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 60px;
            z-index: 999;
            backdrop-filter: blur(10px);
        }
        
        .nav-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: thin;
            scrollbar-color: var(--accent) transparent;
        }
        
        .nav-container::-webkit-scrollbar {
            height: 4px;
        }
        
        .nav-container::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .nav-container::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 2px;
        }
        
        .nav-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid transparent;
            border-radius: 25px;
            color: var(--gray-light);
            font-family: var(--font-body);
            font-weight: 500;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition-normal);
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .nav-btn:hover {
            background: rgba(230, 179, 37, 0.1);
            color: var(--accent);
            border-color: var(--border-accent);
        }
        
        .nav-btn.active {
            background: var(--gradient-accent);
            color: var(--dark);
            font-weight: 600;
            box-shadow: var(--shadow-gold);
        }
        
        /* محتوى الصفحة */
        .page-content {
            flex: 1;
            padding: 30px 20px;
        }
        
        .page-section {
            display: none;
            animation: fadeInUp 0.5s ease;
        }
        
        .page-section.active {
            display: block;
        }
        
        /* بطاقات الصور */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .image-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: var(--transition-normal);
            position: relative;
        }
        
        .image-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent);
        }
        
        .image-container {
            position: relative;
            width: 100%;
            height: 240px;
            overflow: hidden;
        }
        
        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }
        
        .image-card:hover .image-container img {
            transform: scale(1.05);
        }
        
        .image-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
            opacity: 0;
            transition: var(--transition-normal);
            display: flex;
            align-items: flex-end;
            padding: 20px;
        }
        
        .image-card:hover .image-overlay {
            opacity: 1;
        }
        
        .image-watermark {
            color: rgba(255, 255, 255, 0.4);
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .card-content {
            padding: 20px;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-family: var(--font-body);
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-btn.primary {
            background: var(--gradient-primary);
            color: white;
        }
        
        .action-btn.primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 107, 127, 0.3);
        }
        
        .action-btn.secondary {
            background: rgba(230, 179, 37, 0.1);
            color: var(--accent);
            border: 1px solid var(--border-accent);
        }
        
        .action-btn.secondary:hover {
            background: rgba(230, 179, 37, 0.2);
            transform: translateY(-2px);
        }
        
        /* قسم من نحن */
        .about-section {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            background: var(--bg-card);
            border-radius: var(--border-radius-xl);
            border: 1px solid var(--border-color);
        }
        
        .about-content {
            line-height: 1.8;
            color: var(--gray-light);
        }
        
        .about-content h3 {
            color: var(--light);
            margin: 25px 0 15px;
            font-family: var(--font-heading);
            font-size: 1.5rem;
        }
        
        .about-content p {
            margin-bottom: 15px;
        }
        
        /* المساحة الحرة */
        .drawing-section {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-card);
            border-radius: var(--border-radius-xl);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .drawing-header {
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, rgba(42, 107, 127, 0.1), rgba(230, 179, 37, 0.05));
        }
        
        .drawing-tools {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }
        
        .canvas-container {
            padding: 20px;
        }
        
        /* التذييل */
        .main-footer {
            background: var(--gradient-dark);
            padding: 60px 20px 30px;
            margin-top: auto;
            border-top: 1px solid var(--border-color);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-section h4 {
            color: var(--light);
            font-family: var(--font-heading);
            font-size: 1.2rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }
        
        .footer-section h4::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 40px;
            height: 2px;
            background: var(--gradient-accent);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: var(--gray-light);
            text-decoration: none;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer-links a:hover {
            color: var(--accent);
            transform: translateX(5px);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-light);
            text-decoration: none;
            transition: var(--transition-normal);
            border: 1px solid var(--border-color);
        }
        
        .social-link:hover {
            background: var(--accent);
            color: var(--dark);
            transform: translateY(-3px);
            border-color: var(--accent);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* المعرض */
        #viewer {
            position: fixed;
            inset: 0;
            background: var(--bg-overlay);
            z-index: 1000000;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }
        
        .viewer-content {
            max-width: 90vw;
            max-height: 90vh;
            position: relative;
        }
        
        #viewer-img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
        }
        
        .viewer-close {
            position: absolute;
            top: -15px;
            left: -15px;
            width: 50px;
            height: 50px;
            background: var(--gradient-accent);
            border: none;
            border-radius: 50%;
            color: var(--dark);
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-normal);
            box-shadow: var(--shadow-gold);
        }
        
        .viewer-close:hover {
            transform: rotate(90deg) scale(1.1);
        }
        
        /* شريط الأخبار */
        .news-ticker {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            padding: 12px 20px;
            overflow: hidden;
            position: relative;
        }
        
        .ticker-content {
            display: inline-block;
            white-space: nowrap;
            padding-right: 100%;
            animation: ticker 20s linear infinite;
            font-weight: 500;
        }
        
        /* لوحة الإدارة */
        #admin-panel {
            position: fixed;
            inset: 0;
            background: var(--darker);
            z-index: 100000000;
            display: none;
            overflow-y: auto;
        }
        
        .admin-header {
            background: var(--gradient-dark);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .admin-logo {
            font-family: var(--font-heading);
            font-size: 1.8rem;
            color: var(--accent);
        }
        
        .admin-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .admin-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--border-color);
            padding: 25px;
            transition: var(--transition-normal);
        }
        
        .admin-card:hover {
            border-color: var(--accent);
            box-shadow: var(--shadow-gold);
        }
        
        .admin-card h3 {
            color: var(--light);
            font-family: var(--font-heading);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-card h3 i {
            color: var(--accent);
        }
        
        /* حماية المطورين */
        #devtools-overlay {
            position: fixed;
            inset: 0;
            background: var(--bg-overlay);
            z-index: 2147483647;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(20px);
        }
        
        .protection-modal {
            background: var(--bg-card);
            padding: 40px;
            border-radius: var(--border-radius-xl);
            max-width: 500px;
            text-align: center;
            border: 2px solid var(--accent);
            box-shadow: var(--shadow-gold);
        }
        
        /* صيانة */
        #maintenance-screen {
            position: fixed;
            inset: 0;
            background: var(--darker);
            z-index: 99999999;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 30px;
            text-align: center;
            padding: 20px;
        }
        
        /* زر الحماية */
        #protection-toggle {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 60px;
            height: 60px;
            background: var(--gradient-accent);
            border: none;
            border-radius: 50%;
            color: var(--dark);
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 200000001;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-gold);
            transition: var(--transition-normal);
        }
        
        #protection-toggle:hover {
            transform: scale(1.1) rotate(15deg);
        }
        
        #protection-toggle.active {
            background: var(--gradient-primary);
            color: white;
        }
        
        /* الأنيميشن */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes ticker {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
        
        /* المستجدات */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 500;
            font-size: 0.9rem;
            margin: 10px 0;
        }
        
        .status-open {
            background: rgba(46, 204, 113, 0.15);
            color: #2ecc71;
            border: 1px solid #2ecc71;
        }
        
        .status-closed {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        /* تحسينات للجوال */
        @media (max-width: 768px) {
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .nav-btn {
                padding: 10px 18px;
                font-size: 0.9rem;
            }
            
            .top-bar {
                padding: 10px 15px;
            }
            
            .logo-text {
                font-size: 1.2rem;
            }
            
            .page-content {
                padding: 20px 15px;
            }
        }
        
        @media (max-width: 480px) {
            .gallery-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-container {
                padding-bottom: 3px;
            }
            
            .nav-btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
            
            .card-actions {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<!-- شاشة منع أدوات المطورين -->
<div id="devtools-overlay">
    <div class="protection-modal">
        <div style="font-size: 4rem; color: var(--accent); margin-bottom: 20px;">
            <i class="fas fa-shield-alt"></i>
        </div>
        <h2 style="color: var(--light); margin-bottom: 15px; font-family: var(--font-heading);">
            حماية المحتوى
        </h2>
        <p style="color: var(--gray-light); margin-bottom: 25px; line-height: 1.6;">
            هذا الموقع محمي ضد النسخ والتعديل غير المصرح به.<br>
            يرجى إغلاق أدوات المطورين للمتابعة.
        </p>
        <button onclick="document.getElementById('devtools-overlay').style.display='none'; 
                        document.body.style.overflow='auto';"
                style="background: var(--gradient-accent); color: var(--dark); border: none; 
                       padding: 12px 30px; border-radius: 25px; font-weight: 600; 
                       cursor: pointer; transition: var(--transition-normal);">
            <i class="fas fa-check"></i> موافق
        </button>
    </div>
</div>

<!-- شاشة التحميل -->
<div id="splash">
    <div class="splash-logo">
        <i class="fas fa-paint-roller"></i>
    </div>
    <div class="splash-text">بصمة غير للديكور</div>
    <div class="splash-subtext">جاري تحميل المحتوى...</div>
</div>

<!-- شاشة الصيانة -->
<div id="maintenance-screen">
    <div class="splash-logo" style="width: 150px; height: 150px;">
        <i class="fas fa-tools"></i>
    </div>
    <h1 id="maintenance-title" style="font-family: var(--font-heading); font-size: 2.5rem; color: var(--accent);">
        جاري التطوير
    </h1>
    <p id="maintenance-message" style="color: var(--gray-light); max-width: 500px; line-height: 1.6;">
        نعمل على تحسين تجربتك، سنعود قريباً بإصدار جديد ومميز
    </p>
    <div style="width: 300px; height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; margin: 20px 0;">
        <div style="width: 30%; height: 100%; background: var(--gradient-accent); animation: progress 2s infinite ease-in-out;"></div>
    </div>
    <p id="maintenance-footer" style="color: var(--gray); margin-top: 20px;">
        © بصمة غير للديكور
    </p>
</div>

<!-- الشريط العلوي -->
<div class="top-bar">
    <div class="logo-container">
        <div class="logo-icon">
            <i class="fas fa-paint-roller"></i>
        </div>
        <div class="logo-text" id="site-title">بصمة غير</div>
    </div>
    <div class="top-actions">
        <div id="status-container"></div>
        <button onclick="whatsappGlobal()" style="background: var(--gradient-primary); color: white; border: none; padding: 8px 20px; border-radius: 20px; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 8px;">
            <i class="fab fa-whatsapp"></i> تواصل معنا
        </button>
    </div>
</div>

<!-- شريط الشركاء -->
<div class="partners-section">
    <div class="section-header">
        <h2 class="section-title" id="partners-title">شركاء النجاح</h2>
        <p class="section-subtitle">نعمل مع أفضل العلامات التجارية لتقديم حلول ديكور متميزة</p>
    </div>
    <div class="partners-grid" id="partners-display">
        <!-- سيتم ملؤها بالجافاسكريبت -->
    </div>
</div>

<!-- التنقل الرئيسي -->
<div class="main-nav">
    <div class="nav-container" id="navbar">
        <!-- سيتم ملؤها بالجافاسكريبت -->
    </div>
</div>

<!-- شريط الأخبار -->
<div class="news-ticker" id="news-container" style="display: none;">
    <div class="ticker-content" id="news-text"></div>
</div>

<!-- المحتوى الرئيسي -->
<main class="page-content" id="content-area">
    <!-- سيتم ملؤها بالجافاسكريبت -->
</main>

<!-- التذييل -->
<footer class="main-footer">
    <div class="footer-content">
        <div class="footer-section">
            <h4>عن بصمة غير</h4>
            <p style="color: var(--gray-light); line-height: 1.6; margin-bottom: 20px;" id="about-summary">
                نقدم حلول ديكور مبتكرة تجمع بين الأصالة والحداثة، لنصنع لك مساحات تعكس شخصيتك.
            </p>
            <div class="social-links" id="social-links">
                <!-- سيتم ملؤها بالجافاسكريبت -->
            </div>
        </div>
        
        <div class="footer-section">
            <h4>روابط سريعة</h4>
            <ul class="footer-links">
                <li><a href="#" onclick="go('home'); return false;"><i class="fas fa-home"></i> الرئيسية</a></li>
                <li><a href="#" onclick="go('works'); return false;"><i class="fas fa-images"></i> أعمالنا</a></li>
                <li><a href="#" onclick="go('catalogs'); return false;"><i class="fas fa-book"></i> الكتالوج</a></li>
                <li><a href="#" onclick="toggleAbout('about-box'); return false;"><i class="fas fa-info-circle"></i> من نحن</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>معلومات التواصل</h4>
            <ul class="footer-links">
                <li><a href="#" onclick="whatsappGlobal(); return false;"><i class="fab fa-whatsapp"></i> واتساب</a></li>
                <li><a href="#" id="location-link"><i class="fas fa-map-marker-alt"></i> موقعنا</a></li>
                <li><a href="#"><i class="fas fa-clock"></i> <span id="work-hours">أوقات العمل</span></a></li>
                <li><a href="#" onclick="document.getElementById('review-box').classList.toggle('open'); return false;"><i class="fas fa-star"></i> أضف تقييم</a></li>
            </ul>
        </div>
    </div>
    
    <div class="footer-bottom">
        <p id="footer-text">جميع الحقوق محفوظة © بصمة غير للديكور <span id="current-year"></span></p>
    </div>
</footer>

<!-- معرض الصور -->
<div id="viewer" onclick="closeViewerOnOverlay(event)">
    <div class="viewer-content">
        <button class="viewer-close" onclick="closeViewer()">
            <i class="fas fa-times"></i>
        </button>
        <img id="viewer-img" src="">
        <div class="viewer-watermark" id="viewer-watermark" style="position: absolute; bottom: 10px; right: 10px; color: rgba(255,255,255,0.5); font-size: 0.9rem;"></div>
    </div>
</div>

<!-- لوحة التحكم -->
<div id="admin-panel">
    <div class="admin-header">
        <div class="admin-logo">
            <i class="fas fa-cogs"></i> لوحة التحكم
        </div>
        <button onclick="document.getElementById('admin-panel').style.display='none'; location.reload();" 
                style="background: var(--gradient-accent); color: var(--dark); border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <i class="fas fa-sign-out-alt"></i> خروج
        </button>
    </div>
    
    <div class="admin-container">
        <!-- سيتم ملؤها بالجافاسكريبت -->
    </div>
</div>

<!-- زر تفعيل/تعطيل الحماية (للمشرف فقط) -->
<button id="protection-toggle" onclick="toggleProtection()" title="تفعيل/تعطيل الحماية">
    <i class="fas fa-shield-alt"></i>
</button>

<!-- نقطة الدخول المخفية للوحة التحكم -->
<div style="position: fixed; bottom: 100px; left: 20px; width: 50px; height: 50px; opacity: 0; cursor: pointer; z-index: 200000000;" onclick="checkAccess()"></div>

<script>
    // ========== التهيئة الأساسية ==========
    const firebaseConfig = {
        apiKey: "AIzaSyC0hGvWzpb0UxA_RrYn-0PQKyaATXavEGY",
        authDomain: "mydecor-b29bd.firebaseapp.com",
        databaseURL: "https://mydecor-b29bd-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "mydecor-b29bd",
        storageBucket: "mydecor-b29bd.firebasestorage.app",
        messagingSenderId: "302609299720",
        appId: "1:302609299720:web:e086b600c3ee824acd54bd"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();
    const DB_PATH = 'site_v28';
    
    let currentData = {};
    let currentTab = 'home';
    let isAdmin = false;
    let userRating = 0;
    let reviewIdx = 0;
    let partnerIdx = 0;
    let selectedFont = 'tajawal';
    
    // ========== حماية متقدمة ==========
    let isProtectionEnabled = true;
    let protectionSettings = {
        rightClick: true,
        keyboardShortcuts: true,
        imageProtection: true,
        textSelection: true,
        drawingExemption: true
    };
    
    // ========== متغيرات الرسم ==========
    let drawingCanvas, drawingCtx;
    let currentTool = 'pen';
    let currentColor = '#000000';
    let currentBrushSize = 5;
    
    // ========== التهيئة الأولية ==========
    document.addEventListener('DOMContentLoaded', function() {
        enableProtection();
        setupAuthListener();
        loadData();
        setCurrentYear();
        
        // إخفاء شاشة التحميل بعد 3 ثواني
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splash').style.display = 'none';
            }, 500);
        }, 3000);
    });
    
    function setCurrentYear() {
        document.getElementById('current-year').textContent = new Date().getFullYear();
    }
    
    function loadData() {
        db.ref(DB_PATH).on('value', snap => {
            currentData = snap.val() || {};
            
            // التحقق من وضع الصيانة
            if (currentData.maintenance_mode && !isAdmin) {
                showMaintenanceScreen();
            } else {
                hideMaintenanceScreen();
            }
            
            // عرض الأخبار
            if (currentData.news_bar) {
                document.getElementById('news-container').style.display = 'block';
                document.getElementById('news-text').textContent = currentData.news_bar;
            } else {
                document.getElementById('news-container').style.display = 'none';
            }
            
            // تحديث واجهة المستخدم
            updateUI();
            renderAdminPanel();
            
            // تحديث حالة العمل
            updateWorkStatus();
            
            // بدء عرض الشركاء
            startPartnersSlider();
            
            // بدء عرض التقييمات
            startReviewSlider();
            
        }, error => {
            console.error("خطأ في تحميل البيانات:", error);
            document.getElementById('splash').style.display = 'none';
        });
    }
    
    function updateUI() {
        // تحديث العنوان
        if (currentData.site_name) {
            document.getElementById('site-title').textContent = currentData.site_name;
            document.title = currentData.site_name;
        }
        
        // تحديث التذييل
        if (currentData.footer_text) {
            document.getElementById('footer-text').textContent = currentData.footer_text;
        }
        
        // تحديث وصف من نحن
        if (currentData.about_summary) {
            document.getElementById('about-summary').textContent = currentData.about_summary;
        }
        
        // تحديث عنوان الشركاء
        if (currentData.partners_title) {
            document.getElementById('partners-title').textContent = currentData.partners_title;
        }
        
        // تحديث روابط التواصل
        updateSocialLinks();
        
        // عرض المحتوى الرئيسي
        renderContent();
    }
    
    function updateSocialLinks() {
        const socialLinks = document.getElementById('social-links');
        let html = '';
        
        if (currentData.insta_url) {
            html += `<a href="${currentData.insta_url}" target="_blank" class="social-link"><i class="fab fa-instagram"></i></a>`;
        }
        if (currentData.tiktok_url) {
            html += `<a href="${currentData.tiktok_url}" target="_blank" class="social-link"><i class="fab fa-tiktok"></i></a>`;
        }
        if (currentData.snap_url) {
            html += `<a href="${currentData.snap_url}" target="_blank" class="social-link"><i class="fab fa-snapchat-ghost"></i></a>`;
        }
        
        socialLinks.innerHTML = html;
        
        // تحديث رابط الموقع
        if (currentData.location_url) {
            document.getElementById('location-link').href = currentData.location_url;
        }
    }
    
    // ========== عرض المحتوى الرئيسي ==========
    function renderContent() {
        // بناء شريط التنقل
        let navHtml = `
            <button class="nav-btn ${currentTab === 'home' ? 'active' : ''}" onclick="go('home')">
                <i class="fas fa-home"></i> الرئيسية
            </button>
            <button class="nav-btn ${currentTab === 'catalogs' ? 'active' : ''}" onclick="go('catalogs')">
                <i class="fas fa-book"></i> الكتالوج
            </button>`;
        
        if (currentData.drawing_active !== false) {
            navHtml += `
                <button class="nav-btn ${currentTab === 'drawing' ? 'active' : ''}" onclick="go('drawing')">
                    <i class="fas fa-paint-brush"></i> ${currentData.drawing_button_text || 'المساحة الحرة'}
                </button>`;
        }
        
        if (currentData.pages) {
            Object.keys(currentData.pages).forEach(id => {
                navHtml += `
                    <button class="nav-btn ${currentTab === id ? 'active' : ''}" onclick="go('${id}')">
                        <i class="fas fa-folder"></i> ${currentData.pages[id].title}
                    </button>`;
            });
        }
        
        navHtml += `
            <button class="nav-btn ${currentTab === 'works' || currentTab.startsWith('alb-') ? 'active' : ''}" onclick="go('works')">
                <i class="fas fa-images"></i> أعمالنا
            </button>`;
        
        document.getElementById('navbar').innerHTML = navHtml;
        
        // بناء المحتوى الرئيسي
        let contentHtml = '';
        
        // الصفحة الرئيسية
        contentHtml += buildHomePage();
        
        // الكتالوج
        contentHtml += buildCatalogsPage();
        
        // المساحة الحرة
        if (currentData.drawing_active !== false) {
            contentHtml += buildDrawingPage();
        }
        
        // الصفحات المخصصة
        if (currentData.pages) {
            Object.keys(currentData.pages).forEach(id => {
                contentHtml += buildPageSection(id);
            });
        }
        
        // الأعمال
        contentHtml += buildWorksPage();
        
        // الألبومات
        if (currentData.albums) {
            Object.keys(currentData.albums).forEach(id => {
                contentHtml += buildAlbumSection(id);
            });
        }
        
        document.getElementById('content-area').innerHTML = contentHtml;
        
        // تهيئة الرسم إذا كان القسم نشطاً
        if (currentTab === 'drawing') {
            setTimeout(initDrawingCanvas, 300);
        }
    }
    
    function buildHomePage() {
        return `
        <section class="page-section ${currentTab === 'home' ? 'active' : ''}">
            <div class="about-section" id="about-box" style="display: none;">
                <div class="about-content">
                    ${currentData.about_text || '<p>مرحباً بك في بصمة غير للديكور، حيث نحول أحلامك إلى واقع ملموس.</p>'}
                </div>
            </div>
            
            <div style="text-align: center; margin: 40px 0;">
                <button class="action-btn secondary" onclick="toggleAbout('about-box')" style="margin: 0 auto 20px;">
                    <i class="fas fa-info-circle"></i> من نحن
                </button>
                
                <button class="action-btn secondary" onclick="toggleAbout('review-box')" style="margin: 0 auto 20px;">
                    <i class="fas fa-star"></i> أضف تقييمك
                </button>
                
                <div id="review-box" class="about-section" style="display: none; margin-top: 20px;">
                    <div id="review-form">
                        <input type="text" id="rev-name" placeholder="اسمك الكريم" style="width: 100%; margin-bottom: 15px;">
                        <div style="text-align: center; margin: 20px 0;">
                            <div id="star-row" style="display: inline-flex; gap: 5px; direction: ltr;">
                                ${[5,4,3,2,1].map(n => `<i class="fas fa-star" onclick="setStar(${n})" style="font-size: 1.5rem; cursor: pointer; color: #333;"></i>`).join('')}
                            </div>
                        </div>
                        <textarea id="rev-msg" placeholder="شاركنا تجربتك..." rows="4" style="width: 100%; margin-bottom: 15px;"></textarea>
                        <button class="action-btn primary" onclick="submitReview()" style="width: 100%;">
                            <i class="fas fa-paper-plane"></i> إرسال التقييم
                        </button>
                    </div>
                </div>
                
                <div id="reviews-display" class="about-section" style="margin-top: 30px;">
                    <!-- سيتم ملؤها بالتقييمات -->
                </div>
                
                <div class="about-section" style="margin-top: 40px;">
                    <h3 style="color: var(--light); margin-bottom: 25px; font-family: var(--font-heading);">مسار العمل معنا</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: rgba(42, 107, 127, 0.1); padding: 25px; border-radius: var(--border-radius-lg); border: 1px solid var(--border-accent);">
                            <div style="width: 50px; height: 50px; background: var(--gradient-accent); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px;">
                                <i class="fas fa-comments" style="color: var(--dark); font-size: 1.5rem;"></i>
                            </div>
                            <h4 style="color: var(--light); margin-bottom: 10px;">الاستشارة</h4>
                            <p style="color: var(--gray-light); font-size: 0.9rem;">نسمع أفكارك ونساعدك في تحديد رؤيتك بوضوح</p>
                        </div>
                        
                        <div style="background: rgba(42, 107, 127, 0.1); padding: 25px; border-radius: var(--border-radius-lg); border: 1px solid var(--border-accent);">
                            <div style="width: 50px; height: 50px; background: var(--gradient-accent); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px;">
                                <i class="fas fa-ruler-combined" style="color: var(--dark); font-size: 1.5rem;"></i>
                            </div>
                            <h4 style="color: var(--light); margin-bottom: 10px;">التصميم</h4>
                            <p style="color: var(--gray-light); font-size: 0.9rem;">نرسم مخططات دقيقة تعكس ذوقك وتوقعاتك</p>
                        </div>
                        
                        <div style="background: rgba(42, 107, 127, 0.1); padding: 25px; border-radius: var(--border-radius-lg); border: 1px solid var(--border-accent);">
                            <div style="width: 50px; height: 50px; background: var(--gradient-accent); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px;">
                                <i class="fas fa-hammer" style="color: var(--dark); font-size: 1.5rem;"></i>
                            </div>
                            <h4 style="color: var(--light); margin-bottom: 10px;">التنفيذ</h4>
                            <p style="color: var(--gray-light); font-size: 0.9rem;">ننفذ التصميم بدقة عالية وجودة ممتازة</p>
                        </div>
                        
                        <div style="background: rgba(42, 107, 127, 0.1); padding: 25px; border-radius: var(--border-radius-lg); border: 1px solid var(--border-accent);">
                            <div style="width: 50px; height: 50px; background: var(--gradient-accent); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px;">
                                <i class="fas fa-check-circle" style="color: var(--dark); font-size: 1.5rem;"></i>
                            </div>
                            <h4 style="color: var(--light); margin-bottom: 10px;">التسليم</h4>
                            <p style="color: var(--gray-light); font-size: 0.9rem;">نسلم المشروع بكل تفاصيله مع متابعة ما بعد التسليم</p>
                        </div>
                    </div>
                </div>
                
                <div class="about-section" style="margin-top: 40px;">
                    <h3 style="color: var(--light); margin-bottom: 20px; font-family: var(--font-heading);">أوقات العمل</h3>
                    <div style="color: var(--gray-light); margin-bottom: 20px; padding: 20px; background: rgba(255,255,255,0.03); border-radius: var(--border-radius-lg);">
                        ${getSmartSchedule(currentData)}
                    </div>
                </div>
                
                <div style="margin-top: 40px;">
                    <button class="action-btn primary" onclick="whatsappGlobal()" style="padding: 15px 40px; font-size: 1.1rem;">
                        <i class="fab fa-whatsapp"></i> تواصل معنا عبر واتساب
                    </button>
                </div>
            </div>
        </section>`;
    }
    
    function buildCatalogsPage() {
        const catalogs = currentData.catalogs || {};
        const items = Object.keys(catalogs).map(id => `
            <div class="image-card" onclick="openCat('${id}')">
                <div class="image-container">
                    <div style="width: 100%; height: 100%; background: var(--gradient-dark); display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-book" style="font-size: 3rem; color: var(--accent);"></i>
                    </div>
                </div>
                <div class="card-content">
                    <h3 style="color: var(--light); margin-bottom: 10px; font-family: var(--font-heading);">${catalogs[id].name}</h3>
                    <p style="color: var(--gray-light); font-size: 0.9rem;">انقر لعرض الكتالوج</p>
                </div>
            </div>
        `).join('');
        
        return `
        <section class="page-section ${currentTab === 'catalogs' ? 'active' : ''}">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 class="section-title">كتالوجات الديكور</h2>
                <p class="section-subtitle">استعرض مجموعاتنا المميزة من تصاميم الديكور</p>
            </div>
            <div class="gallery-grid">
                ${items || '<p style="grid-column: 1/-1; text-align: center; color: var(--gray); padding: 40px;">لا توجد كتالوجات متاحة حالياً</p>'}
            </div>
        </section>`;
    }
    
    function buildDrawingPage() {
        return `
        <section class="page-section ${currentTab === 'drawing' ? 'active' : ''}">
            <div class="drawing-section">
                <div class="drawing-header">
                    <h2 style="font-family: var(--font-heading); font-size: 2rem; color: var(--light); margin-bottom: 10px;">
                        <i class="fas fa-paint-brush"></i> ${currentData.drawing_title || 'المساحة الحرة'}
                    </h2>
                    <p style="color: var(--gray-light); max-width: 600px; margin: 0 auto;">
                        ${currentData.drawing_description || 'ارسم فكرتك وسنحولها إلى واقع مذهل'}
                    </p>
                </div>
                
                <div class="drawing-tools">
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                        <button class="action-btn secondary" onclick="selectTool('pen')" id="tool-pen">
                            <i class="fas fa-pen"></i> قلم
                        </button>
                        <button class="action-btn secondary" onclick="selectTool('brush')" id="tool-brush">
                            <i class="fas fa-paint-brush"></i> فرشاة
                        </button>
                        <button class="action-btn secondary" onclick="selectTool('eraser')" id="tool-eraser">
                            <i class="fas fa-eraser"></i> ممحاة
                        </button>
                        <input type="color" id="color-picker" value="#000000" onchange="selectColor(this.value)" style="width: 50px; height: 40px; border-radius: 8px; border: 2px solid var(--border-accent); cursor: pointer;">
                        <input type="range" id="brush-size" min="1" max="50" value="5" onchange="changeBrushSize(this.value)" style="width: 100px;">
                    </div>
                </div>
                
                <div class="canvas-container">
                    <canvas id="drawing-canvas" style="width: 100%; height: 500px; background: white; border-radius: var(--border-radius-lg); cursor: crosshair;"></canvas>
                </div>
                
                <div style="padding: 20px; text-align: center;">
                    <button class="action-btn primary" onclick="saveDrawing()" style="margin: 0 10px;">
                        <i class="fas fa-download"></i> حفظ الرسم
                    </button>
                    <button class="action-btn primary" onclick="sendDrawingToWhatsApp()" style="margin: 0 10px;">
                        <i class="fab fa-whatsapp"></i> إرسال عبر واتساب
                    </button>
                    <button class="action-btn secondary" onclick="clearCanvas()" style="margin: 0 10px;">
                        <i class="fas fa-trash"></i> مسح الكل
                    </button>
                </div>
            </div>
        </section>`;
    }
    
    function buildPageSection(id) {
        const page = currentData.pages[id];
        const images = page.imgs || {};
        const items = Object.keys(images).map(imgId => `
            <div class="image-card">
                <div class="image-container" onclick="openImg('${images[imgId].url}')">
                    <img src="${images[imgId].url}" loading="lazy" onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23222%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 fill=%22%23fff%22>صورة</text></svg>'">
                    <div class="image-overlay">
                        <div class="image-watermark">${currentData.wm_text || ''}</div>
                    </div>
                </div>
                <div class="card-content">
                    <div class="card-actions">
                        <button class="action-btn primary" onclick="openImg('${images[imgId].url}')">
                            <i class="fas fa-expand"></i> عرض
                        </button>
                        <button class="action-btn secondary" onclick="whatsappOrder('${images[imgId].url}')">
                            <i class="fab fa-whatsapp"></i> استفسار
                        </button>
                    </div>
                </div>
            </div>
        `).join('');
        
        return `
        <section class="page-section ${currentTab === id ? 'active' : ''}">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 class="section-title">${page.title}</h2>
            </div>
            <div class="gallery-grid">
                ${items || '<p style="grid-column: 1/-1; text-align: center; color: var(--gray); padding: 40px;">لا توجد صور متاحة حالياً</p>'}
            </div>
        </section>`;
    }
    
    function buildWorksPage() {
        const albums = currentData.albums || {};
        const items = Object.keys(albums).map(id => `
            <div class="image-card" onclick="go('alb-${id}')">
                <div class="image-container">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-folder" style="font-size: 3rem; color: white;"></i>
                    </div>
                </div>
                <div class="card-content">
                    <h3 style="color: var(--light); margin-bottom: 10px; font-family: var(--font-heading);">${albums[id].name}</h3>
                    <p style="color: var(--gray-light); font-size: 0.9rem;">انقر لعرض المجموعة</p>
                </div>
            </div>
        `).join('');
        
        return `
        <section class="page-section ${currentTab === 'works' ? 'active' : ''}">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 class="section-title">أعمالنا</h2>
                <p class="section-subtitle">مجموعة مختارة من مشاريعنا المتميزة</p>
            </div>
            <div class="gallery-grid">
                ${items || '<p style="grid-column: 1/-1; text-align: center; color: var(--gray); padding: 40px;">لا توجد ألبومات متاحة حالياً</p>'}
            </div>
        </section>`;
    }
    
    function buildAlbumSection(id) {
        const album = currentData.albums[id];
        const images = album.imgs || {};
        const items = Object.keys(images).map(imgId => `
            <div class="image-card">
                <div class="image-container" onclick="openImg('${images[imgId].url}')">
                    <img src="${images[imgId].url}" loading="lazy" onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23222%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 fill=%22%23fff%22>صورة</text></svg>'">
                    <div class="image-overlay">
                        <div class="image-watermark">${currentData.wm_text || ''}</div>
                    </div>
                </div>
                <div class="card-content">
                    <div class="card-actions">
                        <button class="action-btn primary" onclick="openImg('${images[imgId].url}')">
                            <i class="fas fa-expand"></i> عرض
                        </button>
                        <button class="action-btn secondary" onclick="whatsappOrder('${images[imgId].url}')">
                            <i class="fab fa-whatsapp"></i> استفسار
                        </button>
                    </div>
                </div>
            </div>
        `).join('');
        
        return `
        <section class="page-section ${currentTab === 'alb-' + id ? 'active' : ''}">
            <div style="margin-bottom: 30px;">
                <button class="action-btn secondary" onclick="go('works')" style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-arrow-right"></i> عودة للأعمال
                </button>
            </div>
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 class="section-title">${album.name}</h2>
            </div>
            <div class="gallery-grid">
                ${items || '<p style="grid-column: 1/-1; text-align: center; color: var(--gray); padding: 40px;">لا توجد صور متاحة حالياً</p>'}
            </div>
        </section>`;
    }
    
    // ========== دوال الرسم ==========
    function initDrawingCanvas() {
        const canvas = document.getElementById('drawing-canvas');
        if (!canvas) return;
        
        drawingCanvas = canvas;
        drawingCtx = canvas.getContext('2d');
        
        // تعيين حجم اللوحة
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        
        // إعدادات الرسم الافتراضية
        drawingCtx.fillStyle = '#ffffff';
        drawingCtx.fillRect(0, 0, canvas.width, canvas.height);
        drawingCtx.lineCap = 'round';
        drawingCtx.lineJoin = 'round';
        drawingCtx.lineWidth = currentBrushSize;
        drawingCtx.strokeStyle = currentColor;
        
        // إعداد أحداث الرسم
        setupDrawingEvents();
        selectTool('pen');
    }
    
    function setupDrawingEvents() {
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        
        drawingCanvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
            [lastX, lastY] = [e.offsetX, e.offsetY];
        });
        
        drawingCanvas.addEventListener('mousemove', (e) => {
            if (!isDrawing) return;
            
            drawingCtx.beginPath();
            drawingCtx.moveTo(lastX, lastY);
            drawingCtx.lineTo(e.offsetX, e.offsetY);
            drawingCtx.stroke();
            
            [lastX, lastY] = [e.offsetX, e.offsetY];
        });
        
        drawingCanvas.addEventListener('mouseup', () => isDrawing = false);
        drawingCanvas.addEventListener('mouseout', () => isDrawing = false);
        
        // أحداث اللمس
        drawingCanvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const rect = drawingCanvas.getBoundingClientRect();
            const touch = e.touches[0];
            isDrawing = true;
            [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
        });
        
        drawingCanvas.addEventListener('touchmove', (e) => {
            if (!isDrawing) return;
            e.preventDefault();
            const rect = drawingCanvas.getBoundingClientRect();
            const touch = e.touches[0];
            
            drawingCtx.beginPath();
            drawingCtx.moveTo(lastX, lastY);
            drawingCtx.lineTo(touch.clientX - rect.left, touch.clientY - rect.top);
            drawingCtx.stroke();
            
            [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
        });
        
        drawingCanvas.addEventListener('touchend', () => isDrawing = false);
    }
    
    function selectTool(tool) {
        currentTool = tool;
        
        // تحديد الأزرار
        ['pen', 'brush', 'eraser'].forEach(t => {
            const btn = document.getElementById(`tool-${t}`);
            if (btn) btn.classList.toggle('active', t === tool);
        });
        
        // تحديد إعدادات الرسم
        switch (tool) {
            case 'pen':
                drawingCtx.globalCompositeOperation = 'source-over';
                drawingCtx.lineWidth = currentBrushSize;
                drawingCtx.strokeStyle = currentColor;
                break;
            case 'brush':
                drawingCtx.globalCompositeOperation = 'source-over';
                drawingCtx.lineWidth = currentBrushSize * 2;
                drawingCtx.strokeStyle = currentColor;
                break;
            case 'eraser':
                drawingCtx.globalCompositeOperation = 'destination-out';
                drawingCtx.lineWidth = currentBrushSize * 3;
                break;
        }
    }
    
    function selectColor(color) {
        currentColor = color;
        if (currentTool !== 'eraser') {
            drawingCtx.strokeStyle = color;
        }
    }
    
    function changeBrushSize(size) {
        currentBrushSize = parseInt(size);
        if (currentTool !== 'eraser') {
            drawingCtx.lineWidth = currentTool === 'brush' ? currentBrushSize * 2 : currentBrushSize;
        }
    }
    
    function clearCanvas() {
        if (!drawingCtx) return;
        drawingCtx.fillStyle = '#ffffff';
        drawingCtx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);
    }
    
    function saveDrawing() {
        if (!drawingCanvas) return;
        
        const link = document.createElement('a');
        link.download = `تصميم-بصمة-غير-${Date.now()}.png`;
        link.href = drawingCanvas.toDataURL('image/png');
        link.click();
        
        alert('تم حفظ الرسم بنجاح ✓');
    }
    
    function sendDrawingToWhatsApp() {
        if (!drawingCanvas) return;
        
        const message = currentData.drawing_whatsapp_message || 'السلام عليكم، أود الاستفسار عن هذا الرسم التخطيطي:';
        const whatsappNum = currentData.whatsapp_num || '966500000000';
        
        // يمكن إضافة خاصية إرسال الصورة عبر واتساب هنا
        alert('احفظ الرسم أولاً ثم أرسله لنا عبر واتساب');
        window.open(`https://wa.me/${whatsappNum}?text=${encodeURIComponent(message)}`, '_blank');
    }
    
    // ========== دوال العرض ==========
    function go(id) {
        currentTab = id;
        renderContent();
        window.scrollTo(0, 0);
    }
    
    function toggleAbout(id) {
        const element = document.getElementById(id);
        element.style.display = element.style.display === 'none' ? 'block' : 'none';
    }
    
    function openImg(url) {
        const viewer = document.getElementById('viewer');
        const img = document.getElementById('viewer-img');
        const watermark = document.getElementById('viewer-watermark');
        
        img.src = url;
        watermark.textContent = currentData.wm_text || '';
        viewer.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
    
    function closeViewer() {
        document.getElementById('viewer').style.display = 'none';
        document.body.style.overflow = 'auto';
    }
    
    function closeViewerOnOverlay(event) {
        if (event.target.id === 'viewer') {
            closeViewer();
        }
    }
    
    function openCat(id) {
        const catalog = currentData.catalogs?.[id];
        if (!catalog) return;
        
        // إنشاء نافذة عرض الكتالوج
        const overlay = document.createElement('div');
        overlay.style.cssText = `
            position: fixed;
            inset: 0;
            background: var(--bg-overlay);
            z-index: 10000000;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(10px);
        `;
        
        overlay.innerHTML = `
            <div style="background: var(--bg-nav); padding: 20px; display: flex; justify-content: space-between; align-items: center;">
                <h3 style="color: var(--light); font-family: var(--font-heading);">${catalog.name}</h3>
                <button onclick="this.parentElement.parentElement.remove()" style="background: var(--gradient-accent); color: var(--dark); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="flex: 1; padding: 20px; overflow: auto;">
                ${catalog.code}
            </div>
        `;
        
        document.body.appendChild(overlay);
    }
    
    function whatsappGlobal() {
        const whatsappNum = currentData.whatsapp_num || '966500000000';
        window.open(`https://wa.me/${whatsappNum}?text=${encodeURIComponent('السلام عليكم، أود التواصل مع بصمة غير للديكور.')}`, '_blank');
    }
    
    function whatsappOrder(url) {
        const whatsappNum = currentData.whatsapp_num || '966500000000';
        window.open(`https://wa.me/${whatsappNum}?text=${encodeURIComponent('السلام عليكم، أود الاستفسار عن هذا التصميم:\n' + url)}`, '_blank');
    }
    
    // ========== التقييمات ==========
    function setStar(n) {
        userRating = n;
        const stars = document.querySelectorAll('#star-row i');
        stars.forEach((star, i) => {
            star.style.color = 5 - i <= n ? 'var(--accent)' : '#333';
        });
    }
    
    function submitReview() {
        if (localStorage.getItem('v28_voted')) {
            alert('لقد قمت بالتقييم مسبقاً ✓');
            return;
        }
        
        const name = document.getElementById('rev-name').value;
        const msg = document.getElementById('rev-msg').value;
        
        if (!name || !msg || userRating === 0) {
            alert('يرجى إكمال جميع الحقول');
            return;
        }
        
        db.ref(DB_PATH + '/reviews').push({
            name: name,
            message: msg,
            rating: userRating,
            date: new Date().toLocaleDateString('ar-SA')
        }).then(() => {
            localStorage.setItem('v28_voted', 'true');
            alert('شكراً لتقييمك! ✓');
            document.getElementById('rev-name').value = '';
            document.getElementById('rev-msg').value = '';
            setStar(0);
        }).catch(error => {
            console.error("خطأ في إرسال التقييم:", error);
            alert('خطأ في إرسال التقييم');
        });
    }
    
    function startReviewSlider() {
        if (!currentData.reviews) return;
        
        const reviews = Object.values(currentData.reviews);
        if (reviews.length === 0) return;
        
        const container = document.getElementById('reviews-display');
        if (!container) return;
        
        container.innerHTML = `
            <h3 style="color: var(--light); margin-bottom: 25px; font-family: var(--font-heading);">آراء عملائنا</h3>
            <div id="reviews-slider" style="position: relative; height: 200px; overflow: hidden;">
                ${reviews.map((review, idx) => `
                    <div class="review-slide" id="review-${idx}" style="position: absolute; width: 100%; padding: 20px; background: rgba(255,255,255,0.03); border-radius: var(--border-radius-lg); border: 1px solid var(--border-accent); opacity: 0; transform: translateY(20px); transition: var(--transition-normal);">
                        <div style="color: var(--accent); margin-bottom: 10px;">${'★'.repeat(review.rating)}</div>
                        <p style="color: var(--gray-light); font-style: italic; margin-bottom: 15px;">"${review.message}"</p>
                        <div style="color: var(--light); font-weight: 500;">- ${review.name}</div>
                        <div style="color: var(--gray); font-size: 0.8rem; margin-top: 5px;">${review.date}</div>
                    </div>
                `).join('')}
            </div>
        `;
        
        let current = 0;
        const slides = document.querySelectorAll('.review-slide');
        
        function showSlide(n) {
            slides.forEach(slide => {
                slide.style.opacity = '0';
                slide.style.transform = 'translateY(20px)';
            });
            
            slides[n].style.opacity = '1';
            slides[n].style.transform = 'translateY(0)';
        }
        
        showSlide(0);
        setInterval(() => {
            current = (current + 1) % slides.length;
            showSlide(current);
        }, 4000);
    }
    
    // ========== عرض الشركاء ==========
    function startPartnersSlider() {
        const partners = currentData.partners || {};
        const partnerIds = Object.keys(partners);
        
        if (partnerIds.length === 0) {
            document.getElementById('partners-display').innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--gray);">
                    <i class="fas fa-handshake" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                    <p>شركاؤنا في النجاح</p>
                </div>
            `;
            return;
        }
        
        // عرض جميع الشركاء في وقت واحد
        const partnerCards = partnerIds.map(id => `
            <div class="partner-card">
                <img src="${partners[id].url}" class="partner-logo" alt="شريك" onerror="this.style.display='none'">
            </div>
        `).join('');
        
        document.getElementById('partners-display').innerHTML = partnerCards;
    }
    
    // ========== مواعيد العمل ==========
    function getSmartSchedule(d) {
        if (!d.work_schedule) {
            return "<p>لم يتم تحديد مواعيد العمل بعد</p>";
        }
        
        const daysOrder = [6, 0, 1, 2, 3, 4, 5];
        const dayNames = ["الأحد", "الاثنين", "الثلاثاء", "الأربعاء", "الخميس", "الجمعة", "السبت"];
        
        let scheduleHtml = '<div style="display: grid; gap: 10px;">';
        
        daysOrder.forEach(jsDay => {
            const s = d.work_schedule[jsDay];
            if (!s || !s.active) return;
            
            scheduleHtml += `
                <div style="display: flex; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.02); border-radius: var(--border-radius-sm);">
                    <span style="color: var(--light);">${dayNames[jsDay]}</span>
                    <div style="color: var(--accent);">
                        ${t12(s.s1_s || '09:00')} - ${t12(s.s1_e || '17:00')}
                        ${s.s2_a && s.s2_s && s.s2_e ? `<br><span style="color: var(--accent-light);">${t12(s.s2_s)} - ${t12(s.s2_e)}</span>` : ''}
                    </div>
                </div>
            `;
        });
        
        scheduleHtml += '</div>';
        return scheduleHtml;
    }
    
    function t12(t) {
        if (!t) return "";
        let [h, m] = t.split(':');
        h = parseInt(h);
        return `${h % 12 || 12}:${m}${h >= 12 ? 'م' : 'ص'}`;
    }
    
    function updateWorkStatus() {
        const d = currentData;
        if (!d.work_schedule) return;
        
        const now = new Date();
        const dayJS = now.getDay();
        const schedule = d.work_schedule[dayJS];
        
        let statusHtml = '';
        
        if (schedule && schedule.active) {
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            const toMins = (t) => {
                if (!t) return -1;
                const [h, m] = t.split(':').map(Number);
                return (h * 60) + m;
            };
            
            let isOpen = false;
            const morningStart = toMins(schedule.s1_s || '09:00');
            const morningEnd = toMins(schedule.s1_e || '17:00');
            
            if (currentMinutes >= morningStart && currentMinutes < morningEnd) {
                isOpen = true;
            }
            
            if (!isOpen && schedule.s2_a) {
                const eveningStart = toMins(schedule.s2_s);
                const eveningEnd = toMins(schedule.s2_e);
                
                if (currentMinutes >= eveningStart && currentMinutes < eveningEnd) {
                    isOpen = true;
                }
            }
            
            statusHtml = `
                <div class="status-badge ${isOpen ? 'status-open' : 'status-closed'}">
                    <i class="fas fa-circle" style="font-size: 0.6rem;"></i>
                    ${isOpen ? 'مفتوح الآن' : 'مغلق الآن'}
                </div>
            `;
        } else {
            statusHtml = `
                <div class="status-badge status-closed">
                    <i class="fas fa-circle" style="font-size: 0.6rem;"></i>
                    إجازة اليوم
                </div>
            `;
        }
        
        const container = document.getElementById('status-container');
        if (container) {
            container.innerHTML = statusHtml;
        }
    }
    
    // ========== لوحة التحكم ==========
    function checkAccess() {
        const password = prompt("🔐 أدخل رمز الإدارة:");
        if (!password) return;
        
        db.ref(DB_PATH).once('value').then(snapshot => {
            const data = snapshot.val();
            
            if (!data) {
                alert("❌ لا توجد بيانات في قاعدة البيانات");
                return;
            }
            
            if (data.admin_password && data.admin_password.toString() === password.toString()) {
                showAdminPanel();
                return;
            }
            
            if (data.in && data.in.toString() === password.toString()) {
                showAdminPanel();
                return;
            }
            
            alert("❌ الرمز غير صحيح!");
        }).catch(error => {
            alert("❌ خطأ في الاتصال: " + error.message);
        });
    }
    
    function showAdminPanel() {
        isAdmin = true;
        document.getElementById('admin-panel').style.display = 'block';
        document.getElementById('protection-toggle').style.display = 'flex';
        document.body.style.overflow = 'hidden';
        
        // حماية لوحة التحكم
        document.addEventListener('keydown', adminProtection);
        document.addEventListener('contextmenu', adminProtection);
    }
    
    function adminProtection(e) {
        if (!isAdmin) return;
        
        // منع F12 و Ctrl+Shift+I و Ctrl+U
        if (e.key === 'F12' || 
            (e.ctrlKey && e.shiftKey && e.key === 'I') ||
            (e.ctrlKey && e.key === 'u')) {
            e.preventDefault();
            return false;
        }
    }
    
    function renderAdminPanel() {
        if (!isAdmin) return;
        
        const container = document.querySelector('.admin-container');
        if (!container) return;
        
        container.innerHTML = `
            <div class="admin-grid">
                <!-- قسم الإعدادات العامة -->
                <div class="admin-card">
                    <h3><i class="fas fa-cog"></i> الإعدادات العامة</h3>
                    <input type="text" id="admin-site-name" placeholder="اسم الموقع" value="${currentData.site_name || ''}" style="margin-bottom: 10px;">
                    <input type="text" id="admin-whatsapp" placeholder="رقم واتساب" value="${currentData.whatsapp_num || ''}" style="margin-bottom: 10px;">
                    <input type="text" id="admin-watermark" placeholder="علامة مائية" value="${currentData.wm_text || ''}" style="margin-bottom: 10px;">
                    <textarea id="admin-news" placeholder="شريط الأخبار" style="margin-bottom: 10px;">${currentData.news_bar || ''}</textarea>
                    <textarea id="admin-footer" placeholder="نص التذييل" style="margin-bottom: 10px;">${currentData.footer_text || ''}</textarea>
                    <button class="action-btn primary" onclick="saveGeneralSettings()" style="width: 100%;">
                        <i class="fas fa-save"></i> حفظ الإعدادات
                    </button>
                </div>
                
                <!-- قسم من نحن -->
                <div class="admin-card">
                    <h3><i class="fas fa-info-circle"></i> من نحن</h3>
                    <label style="color: var(--light); margin-bottom: 10px; display: block;">
                        <input type="checkbox" id="admin-about-active" ${currentData.about_active ? 'checked' : ''}> تفعيل القسم
                    </label>
                    <textarea id="admin-about-text" placeholder="محتوى من نحن" rows="8" style="margin-bottom: 10px;">${currentData.about_text || ''}</textarea>
                    <textarea id="admin-about-summary" placeholder="ملخص قصير للتذييل" style="margin-bottom: 10px;">${currentData.about_summary || ''}</textarea>
                    <button class="action-btn primary" onclick="saveAboutSettings()" style="width: 100%;">
                        <i class="fas fa-save"></i> حفظ
                    </button>
                </div>
                
                <!-- قسم الشركاء -->
                <div class="admin-card">
                    <h3><i class="fas fa-handshake"></i> الشركاء</h3>
                    <input type="text" id="admin-partners-title" placeholder="عنوان قسم الشركاء" value="${currentData.partners_title || ''}" style="margin-bottom: 10px;">
                    <div id="admin-partners-list" style="max-height: 200px; overflow-y: auto; margin-bottom: 10px;">
                        ${renderAdminPartnersList()}
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="new-partner-url" placeholder="رابط شعار الشريك" style="flex: 1;">
                        <button class="action-btn primary" onclick="addPartner()">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                
                <!-- قسم الصيانة -->
                <div class="admin-card">
                    <h3><i class="fas fa-tools"></i> وضع الصيانة</h3>
                    <label style="color: var(--light); margin-bottom: 10px; display: block;">
                        <input type="checkbox" id="admin-maintenance" ${currentData.maintenance_mode ? 'checked' : ''}> تفعيل وضع الصيانة
                    </label>
                    <input type="text" id="admin-maintenance-title" placeholder="عنوان الصيانة" value="${currentData.maintenance_title || ''}" style="margin-bottom: 10px;">
                    <textarea id="admin-maintenance-message" placeholder="رسالة الصيانة" rows="3" style="margin-bottom: 10px;">${currentData.maintenance_message || ''}</textarea>
                    <button class="action-btn primary" onclick="saveMaintenanceSettings()" style="width: 100%;">
                        <i class="fas fa-save"></i> حفظ
                    </button>
                </div>
                
                <!-- قسم التواصل -->
                <div class="admin-card">
                    <h3><i class="fas fa-share-alt"></i> وسائل التواصل</h3>
                    <input type="text" id="admin-insta" placeholder="رابط الإنستجرام" value="${currentData.insta_url || ''}" style="margin-bottom: 10px;">
                    <input type="text" id="admin-tiktok" placeholder="رابط التيك توك" value="${currentData.tiktok_url || ''}" style="margin-bottom: 10px;">
                    <input type="text" id="admin-snap" placeholder="رابط السناب شات" value="${currentData.snap_url || ''}" style="margin-bottom: 10px;">
                    <input type="text" id="admin-location" placeholder="رابط الموقع على الخريطة" value="${currentData.location_url || ''}" style="margin-bottom: 10px;">
                    <button class="action-btn primary" onclick="saveSocialSettings()" style="width: 100%;">
                        <i class="fas fa-save"></i> حفظ
                    </button>
                </div>
                
                <!-- قسم الحماية -->
                <div class="admin-card">
                    <h3><i class="fas fa-shield-alt"></i> إعدادات الحماية</h3>
                    <div style="text-align: right;">
                        <label style="display: block; margin-bottom: 10px; color: var(--light);">
                            <input type="checkbox" id="protect-right-click" checked> منع النقر الأيمن
                        </label>
                        <label style="display: block; margin-bottom: 10px; color: var(--light);">
                            <input type="checkbox" id="protect-keyboard" checked> منع اختصارات الكيبورد
                        </label>
                        <label style="display: block; margin-bottom: 10px; color: var(--light);">
                            <input type="checkbox" id="protect-images" checked> منع سحب الصور
                        </label>
                        <label style="display: block; margin-bottom: 10px; color: var(--light);">
                            <input type="checkbox" id="protect-text" checked> منع نسخ النصوص
                        </label>
                    </div>
                    <button class="action-btn primary" onclick="saveProtectionSettings()" style="width: 100%;">
                        <i class="fas fa-save"></i> حفظ الإعدادات
                    </button>
                </div>
            </div>
            
            <div style="margin-top: 30px; text-align: center;">
                <button class="action-btn secondary" onclick="showAdvancedAdmin()" style="margin: 0 10px;">
                    <i class="fas fa-sliders-h"></i> إعدادات متقدمة
                </button>
                <button class="action-btn secondary" onclick="location.reload()" style="margin: 0 10px;">
                    <i class="fas fa-redo"></i> تحديث الصفحة
                </button>
            </div>
        `;
    }
    
    function renderAdminPartnersList() {
        if (!currentData.partners) return '<p style="color: var(--gray); text-align: center;">لا يوجد شركاء</p>';
        
        return Object.keys(currentData.partners).map(id => `
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.03); border-radius: var(--border-radius-sm); margin-bottom: 5px;">
                <img src="${currentData.partners[id].url}" style="width: 30px; height: 30px; object-fit: contain; border-radius: 4px;">
                <span style="flex: 1; color: var(--gray-light); font-size: 0.8rem; overflow: hidden; text-overflow: ellipsis;">${currentData.partners[id].url}</span>
                <button onclick="deletePartner('${id}')" style="background: var(--red); color: white; border: none; width: 30px; height: 30px; border-radius: 4px; cursor: pointer;">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `).join('');
    }
    
    // ========== دوال حفظ الإعدادات ==========
    function saveGeneralSettings() {
        const updates = {
            site_name: document.getElementById('admin-site-name').value,
            whatsapp_num: document.getElementById('admin-whatsapp').value,
            wm_text: document.getElementById('admin-watermark').value,
            news_bar: document.getElementById('admin-news').value,
            footer_text: document.getElementById('admin-footer').value
        };
        
        db.ref(DB_PATH).update(updates).then(() => {
            alert('تم حفظ الإعدادات العامة ✓');
        }).catch(error => {
            alert('خطأ في الحفظ: ' + error.message);
        });
    }
    
    function saveAboutSettings() {
        const updates = {
            about_active: document.getElementById('admin-about-active').checked,
            about_text: document.getElementById('admin-about-text').value,
            about_summary: document.getElementById('admin-about-summary').value
        };
        
        db.ref(DB_PATH).update(updates).then(() => {
            alert('تم حفظ إعدادات "من نحن" ✓');
        }).catch(error => {
            alert('خطأ في الحفظ: ' + error.message);
        });
    }
    
    function addPartner() {
        const url = document.getElementById('new-partner-url').value.trim();
        if (!url) return;
        
        db.ref(DB_PATH + '/partners').push({ url: url }).then(() => {
            document.getElementById('new-partner-url').value = '';
            alert('تم إضافة الشريك ✓');
        }).catch(error => {
            alert('خطأ في الإضافة: ' + error.message);
        });
    }
    
    function deletePartner(id) {
        if (!confirm('هل أنت متأكد من حذف هذا الشريك؟')) return;
        
        db.ref(DB_PATH + '/partners/' + id).remove().then(() => {
            alert('تم حذف الشريك ✓');
        }).catch(error => {
            alert('خطأ في الحذف: ' + error.message);
        });
    }
    
    function saveMaintenanceSettings() {
        const updates = {
            maintenance_mode: document.getElementById('admin-maintenance').checked,
            maintenance_title: document.getElementById('admin-maintenance-title').value,
            maintenance_message: document.getElementById('admin-maintenance-message').value
        };
        
        db.ref(DB_PATH).update(updates).then(() => {
            alert('تم حفظ إعدادات الصيانة ✓');
        }).catch(error => {
            alert('خطأ في الحفظ: ' + error.message);
        });
    }
    
    function saveSocialSettings() {
        const updates = {
            insta_url: document.getElementById('admin-insta').value,
            tiktok_url: document.getElementById('admin-tiktok').value,
            snap_url: document.getElementById('admin-snap').value,
            location_url: document.getElementById('admin-location').value
        };
        
        db.ref(DB_PATH).update(updates).then(() => {
            alert('تم حفظ إعدادات التواصل ✓');
        }).catch(error => {
            alert('خطأ في الحفظ: ' + error.message);
        });
    }
    
    function saveProtectionSettings() {
        const updates = {
            protection_settings: {
                rightClick: document.getElementById('protect-right-click').checked,
                keyboardShortcuts: document.getElementById('protect-keyboard').checked,
                imageProtection: document.getElementById('protect-images').checked,
                textSelection: document.getElementById('protect-text').checked
            }
        };
        
        db.ref(DB_PATH).update(updates).then(() => {
            alert('تم حفظ إعدادات الحماية ✓');
            enableProtection();
        }).catch(error => {
            alert('خطأ في الحفظ: ' + error.message);
        });
    }
    
    function showAdvancedAdmin() {
        const html = `
            <div style="background: var(--bg-card); padding: 30px; border-radius: var(--border-radius-xl); max-width: 800px; margin: 20px auto;">
                <h2 style="color: var(--accent); font-family: var(--font-heading); margin-bottom: 20px; text-align: center;">الإدارة المتقدمة</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                    <div>
                        <h3 style="color: var(--light); margin-bottom: 15px;">إدارة الأقسام</h3>
                        <div id="admin-sections-list" style="margin-bottom: 15px;"></div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="new-section-name" placeholder="اسم قسم جديد" style="flex: 1;">
                            <button class="action-btn primary" onclick="addSection()">إضافة</button>
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="color: var(--light); margin-bottom: 15px;">إدارة الألبومات</h3>
                        <div id="admin-albums-list" style="margin-bottom: 15px;"></div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="new-album-name" placeholder="اسم ألبوم جديد" style="flex: 1;">
                            <button class="action-btn primary" onclick="addAlbum()">إضافة</button>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <button class="action-btn secondary" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i> إغلاق
                    </button>
                </div>
            </div>
        `;
        
        const overlay = document.createElement('div');
        overlay.style.cssText = `
            position: fixed;
            inset: 0;
            background: var(--bg-overlay);
            z-index: 10000001;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            padding: 20px;
        `;
        overlay.innerHTML = html;
        document.body.appendChild(overlay);
        
        renderAdminSections();
        renderAdminAlbums();
    }
    
    function renderAdminSections() {
        const container = document.getElementById('admin-sections-list');
        if (!container) return;
        
        const sections = currentData.pages || {};
        const sectionsHtml = Object.keys(sections).map(id => `
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.03); border-radius: var(--border-radius-sm); margin-bottom: 5px;">
                <input type="text" value="${sections[id].title}" onchange="updateSection('${id}', this.value)" style="flex: 1; background: transparent; border: 1px solid var(--border-color); color: var(--light); padding: 5px; border-radius: 4px;">
                <button onclick="deleteSection('${id}')" style="background: var(--red); color: white; border: none; width: 30px; height: 30px; border-radius: 4px; cursor: pointer;">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `).join('');
        
        container.innerHTML = sectionsHtml || '<p style="color: var(--gray); text-align: center;">لا توجد أقسام</p>';
    }
    
    function renderAdminAlbums() {
        const container = document.getElementById('admin-albums-list');
        if (!container) return;
        
        const albums = currentData.albums || {};
        const albumsHtml = Object.keys(albums).map(id => `
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.03); border-radius: var(--border-radius-sm); margin-bottom: 5px;">
                <input type="text" value="${albums[id].name}" onchange="updateAlbum('${id}', this.value)" style="flex: 1; background: transparent; border: 1px solid var(--border-color); color: var(--light); padding: 5px; border-radius: 4px;">
                <button onclick="deleteAlbum('${id}')" style="background: var(--red); color: white; border: none; width: 30px; height: 30px; border-radius: 4px; cursor: pointer;">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `).join('');
        
        container.innerHTML = albumsHtml || '<p style="color: var(--gray); text-align: center;">لا توجد ألبومات</p>';
    }
    
    function addSection() {
        const name = document.getElementById('new-section-name').value.trim();
        if (!name) return;
        
        db.ref(DB_PATH + '/pages').push({ title: name }).then(() => {
            document.getElementById('new-section-name').value = '';
            alert('تم إضافة القسم ✓');
            renderAdminSections();
        }).catch(error => {
            alert('خطأ في الإضافة: ' + error.message);
        });
    }
    
    function updateSection(id, title) {
        db.ref(DB_PATH + '/pages/' + id).update({ title: title }).then(() => {
            alert('تم تحديث القسم ✓');
        }).catch(error => {
            alert('خطأ في التحديث: ' + error.message);
        });
    }
    
    function deleteSection(id) {
        if (!confirm('هل أنت متأكد من حذف هذا القسم؟')) return;
        
        db.ref(DB_PATH + '/pages/' + id).remove().then(() => {
            alert('تم حذف القسم ✓');
            renderAdminSections();
        }).catch(error => {
            alert('خطأ في الحذف: ' + error.message);
        });
    }
    
    function addAlbum() {
        const name = document.getElementById('new-album-name').value.trim();
        if (!name) return;
        
        db.ref(DB_PATH + '/albums').push({ name: name }).then(() => {
            document.getElementById('new-album-name').value = '';
            alert('تم إضافة الألبوم ✓');
            renderAdminAlbums();
        }).catch(error => {
            alert('خطأ في الإضافة: ' + error.message);
        });
    }
    
    function updateAlbum(id, name) {
        db.ref(DB_PATH + '/albums/' + id).update({ name: name }).then(() => {
            alert('تم تحديث الألبوم ✓');
        }).catch(error => {
            alert('خطأ في التحديث: ' + error.message);
        });
    }
    
    function deleteAlbum(id) {
        if (!confirm('هل أنت متأكد من حذف هذا الألبوم؟')) return;
        
        db.ref(DB_PATH + '/albums/' + id).remove().then(() => {
            alert('تم حذف الألبوم ✓');
            renderAdminAlbums();
        }).catch(error => {
            alert('خطأ في الحذف: ' + error.message);
        });
    }
    
    // ========== نظام الحماية ==========
    function enableProtection() {
        // منع النقر الأيمن
        document.addEventListener('contextmenu', e => {
            if (isProtectionEnabled) e.preventDefault();
        });
        
        // منع اختصارات الكيبورد
        document.addEventListener('keydown', e => {
            if (!isProtectionEnabled) return;
            
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.key === 'u')) {
                e.preventDefault();
                showDevToolsWarning();
            }
        });
        
        // منع سحب الصور
        document.addEventListener('dragstart', e => {
            if (isProtectionEnabled && e.target.tagName === 'IMG') {
                e.preventDefault();
            }
        });
        
        // منع نسخ النصوص
        document.addEventListener('copy', e => {
            if (isProtectionEnabled) {
                e.preventDefault();
                return false;
            }
        });
    }
    
    function toggleProtection() {
        isProtectionEnabled = !isProtectionEnabled;
        const btn = document.getElementById('protection-toggle');
        
        if (isProtectionEnabled) {
            btn.classList.remove('active');
            btn.innerHTML = '<i class="fas fa-shield-alt"></i>';
            alert('الحماية مفعلة ✓');
        } else {
            btn.classList.add('active');
            btn.innerHTML = '<i class="fas fa-shield-slash"></i>';
            alert('الحماية معطلة ⚠️');
        }
    }
    
    function showDevToolsWarning() {
        if (isAdmin) return;
        
        const overlay = document.getElementById('devtools-overlay');
        overlay.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
    
    // ========== شاشة الصيانة ==========
    function showMaintenanceScreen() {
        const screen = document.getElementById('maintenance-screen');
        const title = currentData.maintenance_title || 'جاري التطوير';
        const message = currentData.maintenance_message || 'نعمل على تحسين تجربتك، سنعود قريباً بإصدار جديد ومميز';
        const footer = currentData.maintenance_footer || '© بصمة غير للديكور';
        
        document.getElementById('maintenance-title').textContent = title;
        document.getElementById('maintenance-message').textContent = message;
        document.getElementById('maintenance-footer').textContent = footer;
        
        screen.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
    
    function hideMaintenanceScreen() {
        const screen = document.getElementById('maintenance-screen');
        screen.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
    
    // ========== نظام المصادقة ==========
    function setupAuthListener() {
        auth.onAuthStateChanged(user => {
            if (user) {
                isAdmin = true;
                document.getElementById('protection-toggle').style.display = 'flex';
            }
        });
    }
    
    // تحديث حالة العمل كل دقيقة
    setInterval(updateWorkStatus, 60000);
    
    // تحميل إعدادات الحماية
    db.ref(DB_PATH + '/protection_settings').once('value').then(snapshot => {
        const settings = snapshot.val();
        if (settings) {
            protectionSettings = settings;
        }
    });
</script>
</body>
</html>
